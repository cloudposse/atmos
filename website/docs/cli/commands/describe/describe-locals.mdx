---
title: atmos describe locals
sidebar_label: locals
sidebar_class_name: command
id: locals
description: Use this command to display the locals defined in Atmos stack manifests.
---
import Terminal from '@site/src/components/Terminal'
import Screengrab from '@site/src/components/Screengrab'
import Intro from '@site/src/components/Intro'

<Intro>
Use this command to display the [locals](/stacks/locals) defined in Atmos stack manifests.
This is useful for debugging and understanding how locals are configured across your stacks.
</Intro>

:::info Understanding Stack Resolution
When you specify `--stack`, Atmos resolves it to a stack manifest file and returns **only the locals defined in that file** (not inherited from imports). The `--stack` flag accepts either:
- A **logical stack name** derived from your `atmos.yaml` naming pattern (e.g., `prod-us-east-1`)
- A **stack manifest file path** (e.g., `deploy/prod`)

Both resolve to the same underlying file. Locals are file-scoped, so the output reflects what's defined in that specific manifest.
:::

<Screengrab title="atmos describe locals --help" slug="atmos-describe-locals--help" />

## Usage

Execute the `describe locals` command like this:

```shell
atmos describe locals [component] [options]
```

When called without arguments, it shows all locals organized by stack.
When a component is specified with `--stack`, it shows the merged locals that would be **available to** that component (global + component-type-specific). The component argument determines which section-specific locals to include (e.g., `terraform:` locals for a Terraform component), but the locals themselves come from the stack manifest file, not the component definition.

:::tip
Run `atmos describe locals --help` to see all the available options
:::

## Examples

```shell
# Show locals for all stacks
atmos describe locals

# Show locals for a specific stack (using file path)
atmos describe locals --stack deploy/dev

# Show locals for a specific stack (using logical stack name derived from atmos.yaml)
atmos describe locals -s prod-us-east-1

# Show locals available to a specific component in a stack
# The component determines which section-specific locals to merge (terraform/helmfile/packer)
atmos describe locals vpc -s prod
atmos describe locals eks --stack prod-us-east-1

# Output as JSON
atmos describe locals --format json
atmos describe locals vpc -s prod -f json

# Write to file
atmos describe locals --file locals.yaml

# Query specific values (note: stack key is the file path, not logical name)
atmos describe locals --query '.["deploy/dev"].merged.namespace'
```

## Arguments

<dl>
  <dt>`component` <em>(optional)</em></dt>
  <dd>The name of a component. When specified with `--stack`, shows the merged locals that would be <strong>available to</strong> that component. Atmos determines the component's type (terraform, helmfile, or packer) and merges the global locals with the corresponding section-specific locals from the stack manifest file. The locals come from the file, not the component definition itself.</dd>
</dl>

## Flags

<dl>
  <dt>`--stack` / `-s` <em>(optional, required with component)</em></dt>
  <dd>Filter by a specific stack. Accepts two formats: (1) <strong>Stack manifest file path</strong> - direct path relative to your stacks directory (e.g., <code>deploy/dev</code>, <code>prod</code>), or (2) <strong>Logical stack name</strong> - the derived name based on your <code>atmos.yaml</code> naming pattern (e.g., <code>prod-us-east-1</code>). Atmos resolves either format to the underlying stack manifest file and returns only the locals defined in that file. Required when a component argument is provided.</dd>

  <dt>`--format` / `-f` <em>(optional)</em></dt>
  <dd>Output format: `yaml` or `json` (`yaml` is default).</dd>

  <dt>`--file` <em>(optional)</em></dt>
  <dd>If specified, write the result to the file.</dd>

  <dt>`--query` / `-q` <em>(optional)</em></dt>
  <dd>Query the results of the command using `yq` expressions.<br/><br/>`atmos describe locals --query <yq-expression>`<br/><br/>For more details, refer to https://mikefarah.gitbook.io/yq.</dd>
</dl>

## Output

The command outputs locals organized by stack, with each stack containing the following sections:

<dl>
  <dt>`global`</dt>
  <dd>Root-level locals defined at the top of the stack manifest file.</dd>

  <dt>`terraform`</dt>
  <dd>Locals defined within the `terraform:` section (only shown if explicitly defined).</dd>

  <dt>`helmfile`</dt>
  <dd>Locals defined within the `helmfile:` section (only shown if explicitly defined).</dd>

  <dt>`packer`</dt>
  <dd>Locals defined within the `packer:` section (only shown if explicitly defined).</dd>

  <dt>`merged`</dt>
  <dd>All locals merged together. Global locals are applied first, then section-specific locals override them. This represents what is available during template processing.</dd>
</dl>

## Example Output

<Terminal title="atmos describe locals --stack deploy/dev">
```yaml
deploy/dev:
  global:
    environment: dev
    namespace: acme
    name_prefix: acme-dev
    full_name: acme-dev-us-east-1
    tags:
      Environment: dev
      Namespace: acme
  terraform:
    backend_bucket: acme-dev-tfstate
    tf_specific: terraform-only
  merged:
    backend_bucket: acme-dev-tfstate
    environment: dev
    full_name: acme-dev-us-east-1
    name_prefix: acme-dev
    namespace: acme
    tags:
      Environment: dev
      Namespace: acme
    tf_specific: terraform-only
```
</Terminal>

### Component-Specific Output

When a component is specified with `--stack`, the output shows the locals that would be **available to** that component during template processing. The output includes the component name, stack, component type, and the merged locals:

<Terminal title="atmos describe locals vpc -s prod-ue2">
```yaml
component: vpc
stack: prod-ue2
component_type: terraform
locals:
  backend_bucket: acme-prod-tfstate
  environment: prod
  full_name: acme-prod-us-east-1
  name_prefix: acme-prod
  namespace: acme
  tf_specific: terraform-only
```
</Terminal>

The `component_type` field shows how Atmos determined which section-specific locals to include. Since `vpc` is a Terraform component, Atmos merged the global locals with the `terraform:` section locals from the stack manifest file.

:::note
The locals shown come from the **stack manifest file**, not the component definition. The component argument only determines which section-specific locals (terraform/helmfile/packer) to merge with the global locals.
:::

## How Locals Work

Locals are file-scoped variables that can reference each other and are resolved before template processing. They provide a way to define computed values that can be used throughout the stack manifest.

### Defining Locals

```yaml
# stacks/deploy/dev.yaml
locals:
  namespace: acme
  environment: dev
  # Locals can reference other locals
  name_prefix: "{{ .locals.namespace }}-{{ .locals.environment }}"
  backend_bucket: "{{ .locals.name_prefix }}-tfstate"

components:
  terraform:
    vpc:
      vars:
        # Use locals in component vars
        name: "{{ .locals.name_prefix }}-vpc"
        bucket: "{{ .locals.backend_bucket }}"
```

### Section-Specific Locals

Locals can be defined at section level (terraform, helmfile, packer) to override global locals:

```yaml
locals:
  namespace: global-acme

terraform:
  locals:
    # Overrides global namespace for terraform components
    namespace: terraform-acme
    backend_bucket: "{{ .locals.namespace }}-tfstate"
```

### File-Scoped Behavior

Locals are **file-scoped** and are NOT inherited across imports. Each stack manifest file can only access its own locally defined `locals` section. This prevents unintended side effects from imported files.

This is a key design principle: when you run `atmos describe locals --stack deploy/dev`, you get **only** the locals defined in the `deploy/dev.yaml` file itself, regardless of what files it imports. The `--stack` flag accepts either:
- The file path (`deploy/dev`)
- The logical stack name derived from your naming pattern (e.g., `dev-us-east-1`)

Both resolve to the same file and return the same locals.

```yaml
# mixins/base.yaml
locals:
  mixin_value: "from-mixin"  # NOT available to importing files

# stacks/deploy/dev.yaml
import:
  - mixins/base

locals:
  file_value: "from-file"  # Available in this file

components:
  terraform:
    myapp:
      vars:
        value: "{{ .locals.file_value }}"       # Works: "from-file"
        mixin: "{{ .locals.mixin_value }}"      # Does NOT work: "<no value>"
```

:::note
Regular `vars` ARE inherited across imports (normal Atmos behavior). Only `locals` are file-scoped.
:::

## Related Commands

- [`atmos describe component`](/cli/commands/describe/component) - Describe a component's full configuration including resolved locals
- [`atmos describe stacks`](/cli/commands/describe/stacks) - Describe all stacks and their configurations

## Related Documentation

- [File-Scoped Locals](/stacks/locals) - Learn more about defining and using locals in stack manifests
