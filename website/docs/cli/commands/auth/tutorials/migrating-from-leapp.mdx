---
title: Migrating from Leapp
sidebar_label: Migrating from Leapp
sidebar_position: 9
id: migrating-from-leapp
description: Guide for migrating from Leapp to Atmos Auth for AWS IAM Identity Center authentication.
---
> **Note**: This guide currently covers AWS IAM Identity Center (SSO) migrations only. Support for other authentication methods will be added in future updates.

> **Note**: `atmos auth` requires minimum Atmos version `v1.194.1`

This guide helps you migrate from Leapp to the native `atmos auth` authentication system.

## Overview

Leapp is a standalone credential management application with a graphical interface. Atmos Auth provides similar functionality but integrates authentication directly into your infrastructure workflow with configuration-as-code.

## Understanding Leapp Components

In Leapp, authentication consists of:

1. **Provider**: SSO integration (e.g., "acme") connecting to AWS IAM Identity Center
2. **Session**: Individual AWS access configuration (account + permission set + provider)
3. **Identity**: Permission set name (e.g., "IdentityManagersTeamAccess")
4. **Named Profile**: Profile name used in AWS CLI
5. **Region**: AWS region for the session

## Quick Migration Example

### What You See in Leapp

![Leapp Session Example](/img/leapp-example.png)

A typical Leapp session shows:
- **Provider**: acme (in sidebar under "Integrations")
- **Session**: core-identity
- **Identity**: IdentityManagersTeamAccess
- **Named Profile**: acme-identity
- **Region**: US-EAST-1

### Equivalent `atmos auth` Configuration

```yaml
auth:
  providers:
    acme-sso: # (1)
      kind: aws/iam-identity-center
      region: us-east-2 # (5)
      start_url: https://acme.awsapps.com/start/ # (1.a)

  identities:
    acme-identity: # (4)
      kind: aws/permission-set
      via:
        provider: acme-sso
      principal:
        name: "IdentityManagersTeamAccess" # (3)
        account:
          name: "core-identity" # (2)
```

## Field Mapping Reference

| Leapp Field | `atmos auth` Location | Notes |
|-------------|----------------------|-------|
| (1) Provider name | `providers.<name>` | Use a descriptive name (e.g., `acme-sso`) |
| (1.a) Start URL | `providers.<name>.start_url` | Found in AWS IAM Identity Center portal |
| (5) Region | `providers.<name>.region` | From Leapp session's Region column |
| (2) Session (account) | `identities.<name>.principal.account.name` | AWS account name |
| (3) Identity (permission set) | `identities.<name>.principal.name` | Exact permission set name |
| (4) Named Profile | `identities.<name>` (key) | Use descriptive naming: `account/role` |

## Step-by-Step Migration

### 1. Identify Your Provider Configuration

In Leapp, find your provider in the left sidebar under "Integrations".

**Create the provider in `atmos.yaml`:**

```yaml
auth:
  providers:
    <provider-name>:
      kind: aws/iam-identity-center
      region: <region>
      start_url: <your-sso-start-url>
```

**Example:**
```yaml
auth:
  providers:
    acme-sso:
      kind: aws/iam-identity-center
      region: us-east-2
      start_url: https://acme.awsapps.com/start/
```

### 2. Convert Each Session to an Identity

For each session in Leapp you use, create an identity configuration:

```yaml
auth:
  identities:
    <account-name>/<descriptive-role-name>:
      kind: aws/permission-set
      via:
        provider: <provider-name>
      principal:
        name: "<PermissionSetName>"
        account:
          name: "<account-name>"
```

**Example:**
```yaml
auth:
  identities:
    acme-identity:
      kind: aws/permission-set
      via:
        provider: acme-sso
      principal:
        name: "IdentityManagersTeamAccess"
        account:
          name: "core-identity"
```

### 3. Set a Default Identity (Optional)

Mark one identity as default for convenience:

```yaml
auth:
  identities:
    acme-identity:
      default: true
      kind: aws/permission-set
      via:
        provider: acme-sso
      principal:
        name: "IdentityManagersTeamAccess"
        account:
          name: "core-identity"
```

### 4. Test Your Configuration

```bash
# Validate configuration
atmos auth validate

# Login with default identity
atmos auth login

# Check authentication status
atmos auth whoami

# Use with Terraform
atmos terraform plan <component> -s <stack>
```

## Integration with Geodesic

If you're using [Geodesic](https://github.com/cloudposse/geodesic) as your DevOps toolbox, you'll need to update your Dockerfile to configure the default AWS authentication settings for Atmos.

### Updating Your Geodesic Dockerfile

Add the following environment variables to your Geodesic Dockerfile:

```dockerfile
# Default AWS_PROFILE
# This identity must exist in the atmos config file.
ARG DEFAULT_ATMOS_PROVIDER="acme-sso"
ARG DEFAULT_ATMOS_IDENTITY="acme-identity"

ENV AWS_SHARED_CREDENTIALS_FILE=$HOME/.aws/atmos/${DEFAULT_ATMOS_PROVIDER}/credentials
ENV AWS_CONFIG_FILE=$HOME/.aws/atmos/${DEFAULT_ATMOS_PROVIDER}/config
ENV AWS_PROFILE=${DEFAULT_ATMOS_IDENTITY}

# This sets the default AWS_CONFIG to be used after signing into AWS with Atmos.
# Once logged in, this config file gives you access to all the other teams
# and roles (if you are authorized for access).
ENV AWS_CONFIG_FILE=/etc/aws-config/aws-config-teams
ENV ASSUME_ROLE_INTERACTIVE_QUERY=${NAMESPACE}${TENANT:+-$TENANT}-gbl-
```

### Update `Makefile`

We need the following snippet in our `Makefile`:

```makefile
login:
	@atmos auth login --identity core-identity

...

## Start the geodesic shell by calling wrapper script
run: login
	@$(APP_NAME)
```
### Update Source Profile

In order for `assume-role` and other Geodesic utilities to work, you'll need to update your `source_profile` in your `{Repo Root}/etc/aws-config/aws-config-teams` file to match the identity name from your `atmos.yaml` auth configuration.

## Troubleshooting

### Issue: "Provider not found" error

**Cause**: The provider name in `via.provider` doesn't match a defined provider.

**Solution**: Ensure the provider name matches exactly:
```yaml
providers:
  acme-sso:  # ← This name
    kind: aws/iam-identity-center

identities:
  my-identity:
    via:
      provider: acme-sso  # ← Must match exactly
```

### Issue: "Permission set not found"

**Cause**: The permission set name doesn't match what's configured in AWS IAM Identity Center.

**Solution**: Use the exact permission set name from AWS:
```yaml
principal:
  name: "IdentityManagersTeamAccess"  # ← Must match AWS exactly
```

### Issue: Authentication fails with MFA

**Cause**: Atmos Auth handles MFA automatically during SSO login.

**Solution**: No action needed. Follow the browser prompts during `atmos auth login`.

## Next Steps

- Read the [User Guide](/cli/commands/auth/usage) for detailed usage instructions
- Review the [auth commands](/cli/commands/auth/login) reference
- Explore [component-level authentication](/cli/commands/auth/usage#component-level-configuration) options

## Getting Help

If you encounter issues during migration:

1. Run `atmos auth validate --verbose` to check configuration
2. Check the [User Guide](/cli/commands/auth/usage) for common scenarios
3. Review error messages carefully - they often indicate the exact issue
4. Ensure your AWS IAM Identity Center configuration is correct

---

**Ready to migrate?** Start by identifying your Leapp provider and creating the equivalent configuration in `atmos.yaml`.
