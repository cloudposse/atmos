# Customizing Columns in Atmos List Commands

## Overview

Atmos supports customizable columns for all `list` commands (e.g., `list stacks`, `list components`, `list workflows`, etc.).
Columns are configured in your `atmos.yaml` using Go template expressions for dynamic values.
This enables tailored tabular output for different environments, components, or workflows.

## Table of Contents

- [Supported List Commands](#supported-list-commands)
- [How Column Customization Works](#how-column-customization-works)
- [YAML Template Syntax](#yaml-template-syntax)
- [Example: Custom Columns for Stacks](#example-custom-columns-for-stacks)
- [Example: Custom Columns for Components](#example-custom-columns-for-components)
- [Example: Custom Columns for Workflows](#example-custom-columns-for-workflows)
- [Full Reference: atmos.yaml Structure](#full-reference-atmosyaml-structure)
- [Sidebar and Navigation](#sidebar-and-navigation)
- [Troubleshooting & Tips](#troubleshooting--tips)

---

## Supported List Commands

- `atmos list stacks`
- `atmos list components`
- `atmos list workflows`
- `atmos list values`
- `atmos list vars`
- `atmos list settings`
- `atmos list metadata`

Each command can be configured with custom columns in `atmos.yaml`.

---

## How Column Customization Works

Under the relevant section (e.g., `stacks`, `components`, `workflows`) in your `atmos.yaml`, define a `list` block.
Specify the output `format` (optional, defaults to `table`).
Define a `columns` array, with each column having:
  - `name`: The column header as shown in the output table.
  - `value`: A Go template string that determines the value for each row.

---

## YAML Template Syntax

The `value` field supports Go templates with variables specific to each list command type:

### For `workflows` list command:
```yaml
{{ .workflow_file }}      # The filename containing the workflow
{{ .workflow_name }}      # The name of the workflow
{{ .workflow_description }}  # The workflow description
```

### For `components` list command:
```yaml
{{ .component_name }}  # Name of the component
{{ .component_type }}  # Type of the component (terraform, helmfile, etc.)
```

### For `values`, `vars`, `settings`, and `metadata` commands:
```yaml
{{ .stack_name }}  # Name of the stack
{{ .key }}         # Key/property name in the component configuration
{{ .value }}       # Value for the key in the component configuration
```

**Example:**
```yaml
value: "{{ .stack_name }}"
```

---

## Example: Custom Columns for Stacks

```yaml
stacks:
  list:
    format: table
    columns:
      - name: Stack
        value: "{{ .stack_name }}"
      - name: Path
        value: "{{ .stack_path }}"
```

---

## Example: Custom Columns for Components

```yaml
components:
  list:
    columns:
      - name: Component
        value: "{{ .component_name }}"
      - name: Type
        value: "{{ .component_type }}"
      - name: Path
        value: "{{ .component_path }}"
```

---

## Example: Custom Columns for Workflows

```yaml
workflows:
  list:
    columns:
      - name: Workflow Name
        value: "{{ .workflow_name }}"
      - name: File
        value: "{{ .workflow_file }}"
      - name: Description
        value: "{{ .workflow_description }}"
```

---

## Full Reference: atmos.yaml Structure

```yaml
<top-level-section>:
  list:
    format: table|json|csv|yaml|tsv  # Optional, default is table
    columns:
      - name: <Column Header>
        value: <Go template string>
      # ... more columns
```

- Replace `<top-level-section>` with `stacks`, `components`, `workflows`, etc.
- The `columns` array is required for custom column configuration.

---

## Sidebar and Navigation

- Ensure each list command's documentation page links to this customization guide.
- Sidebar should reflect all supported list commands and this new section.
- If sidebar is manually configured, update the sidebar config file to include a link to "Customizing Columns in List Commands".

---

## Display Behavior

### TTY vs Non-TTY Output

- **TTY Output (Interactive Terminal)**
  - Uses formatted tables with styling
  - Respects terminal width constraints
  - Applies proper column padding (TableColumnPadding = 3)
  - Default format is `table`

- **Non-TTY Output (Script/Pipeline)**
  - Uses simplified machine-readable format
  - Supports automation and scripting use cases
  - Maintains consistent output structure
  - Better for programmatic consumption

## Troubleshooting & Tips

- If a column value is blank, check your template variable names and data context.
- Use `--format json` or `--format yaml` to inspect available fields for templating.
- For very wide tables, use the `--max-columns` flag (default: 10 or 50, depending on command) or reduce the number of columns in your config.
- Column width can be constrained by terminal width. If you see an error about content being too wide, try reducing the number of columns or using a different output format.
- Use proper column padding (3 characters) when manually calculating widths.
- Use stack pattern filtering (`--stack '*-dev-*'`) to reduce the number of columns in the output.
- Query flags (`--query '.vars'`) can help target specific sections of the data.
