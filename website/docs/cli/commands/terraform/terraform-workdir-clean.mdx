---
title: atmos terraform workdir clean
sidebar_label: workdir clean
sidebar_class_name: command
id: workdir-clean
description: Remove workdir(s) to free disk space or force regeneration.
---
import Intro from '@site/src/components/Intro'
import Screengrab from '@site/src/components/Screengrab'

<Intro>
Use this command to remove workdirs from your project. This is useful for freeing disk space, forcing regeneration of workdirs, or cleaning up after components are removed.
</Intro>

<Screengrab title="atmos terraform workdir clean --help" slug="atmos-terraform-workdir-clean--help" />

## Usage

```shell
atmos terraform workdir clean [component] [flags]
```

## Arguments

<dl>
    <dt>`component`</dt>
    <dd>Optional. The name of the Terraform component whose workdir you want to clean. If not specified, use `--all` to clean all workdirs.</dd>
</dl>

## Flags

<dl>
    <dt>`-s, --stack`</dt>
    <dd>The stack name for the component. Required when cleaning a specific component.</dd>

    <dt>`--all`</dt>
    <dd>Clean all workdirs in the project. Cannot be used with a specific component.</dd>

    <dt>`--force`</dt>
    <dd>Skip confirmation prompt.</dd>

    <dt>`--dry-run`</dt>
    <dd>Show what would be cleaned without actually removing anything.</dd>
</dl>

## Examples

### Clean a Specific Workdir

```shell
# Clean the workdir for vpc component in dev stack
atmos terraform workdir clean vpc --stack dev
```

Output:

```
Cleaned workdir: .workdir/terraform/dev-vpc
```

### Clean All Workdirs

```shell
# Clean all workdirs in the project
atmos terraform workdir clean --all
```

Output:

```
This will remove all workdirs in .workdir/terraform/
Continue? [y/N]: y
Cleaned 5 workdirs:
  - dev-vpc
  - staging-vpc
  - prod-vpc
  - dev-s3-bucket
  - staging-s3-bucket
```

### Dry Run

```shell
# See what would be cleaned without removing
atmos terraform workdir clean --all --dry-run
```

Output:

```
Would clean 5 workdirs:
  - .workdir/terraform/dev-vpc
  - .workdir/terraform/staging-vpc
  - .workdir/terraform/prod-vpc
  - .workdir/terraform/dev-s3-bucket
  - .workdir/terraform/staging-s3-bucket
```

### Force Clean Without Confirmation

```shell
# Clean all workdirs without confirmation prompt
atmos terraform workdir clean --all --force
```

## When to Clean Workdirs

Consider cleaning workdirs in these scenarios:

1. **Disk Space** - Workdirs can accumulate significant disk space over time, especially with large `.terraform` directories containing provider binaries.

2. **Force Regeneration** - If you suspect workdir contents are stale or corrupted, cleaning forces a fresh copy on the next `terraform init`.

3. **Component Removal** - After removing a component from your configuration, clean its workdir to remove orphaned files.

4. **Troubleshooting** - When debugging Terraform issues, starting with a clean workdir can help isolate problems.

## Workdir Regeneration

After cleaning a workdir, it will be automatically recreated the next time you run a Terraform command:

```shell
# Clean the workdir
atmos terraform workdir clean vpc --stack dev

# Workdir is recreated on next init
atmos terraform init vpc --stack dev
```

## Safety Considerations

:::warning
Cleaning a workdir removes all Terraform state-related files in that directory, including:
- Downloaded provider plugins (`.terraform/`)
- Lock files (`.terraform.lock.hcl`)
- Generated varfiles and planfiles

This does **not** affect your remote Terraform state (e.g., S3 backend). However, you will need to re-run `terraform init` to download providers again.
:::

## Related Commands

- [`atmos terraform workdir list`](/cli/commands/terraform/workdir-list) - List all workdirs
- [`atmos terraform workdir show`](/cli/commands/terraform/workdir-show) - Show workdir details
- [`atmos terraform workdir describe`](/cli/commands/terraform/workdir-describe) - Output workdir as stack manifest
- [`atmos terraform clean`](/cli/commands/terraform/clean) - Clean Terraform files from component directories
- [`atmos terraform init`](/cli/commands/terraform/init) - Initialize and recreate workdir
