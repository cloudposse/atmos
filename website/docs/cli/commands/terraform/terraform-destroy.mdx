---
title: atmos terraform destroy
sidebar_label: destroy
sidebar_class_name: command
id: destroy
---
import Intro from '@site/src/components/Intro'
import Screengrab from '@site/src/components/Screengrab'
import Terminal from '@site/src/components/Terminal'

<Intro>
Use this command to destroy Terraform-managed infrastructure for an Atmos component in a stack. This operation removes all resources managed by the component.
</Intro>

<Screengrab title="atmos terraform destroy --help" slug="atmos-terraform-destroy--help" />

## Usage

Execute the `terraform destroy` command like this:

```shell
atmos terraform destroy <component> -s <stack> [options]
```

This command creates a plan to destroy all resources managed by the given configuration and state, and then applies that plan.

:::info Atmos Enhancements
Atmos enhances the destroy command with:
- Automatic `terraform init` before destroying
- Workspace selection and management
- **Automatic variable file generation and passing**
- Backend configuration
- Component validation and locking support
:::

## Configuration

Configure default behavior for `terraform destroy` in your `atmos.yaml`:

```yaml
components:
  terraform:
    # Auto-generate backend configuration
    auto_generate_backend_file: true
```

These settings can also be controlled via environment variables:
```shell
export ATMOS_COMPONENTS_TERRAFORM_AUTO_GENERATE_BACKEND_FILE=true
```

## Examples

### Basic Destroy

```shell
# Destroy a component in a stack (will prompt for confirmation)
atmos terraform destroy vpc -s dev
```

### Auto-Approve Destroy

```shell
# Destroy without confirmation prompt (use with caution!)
atmos terraform destroy vpc -s dev -auto-approve
```

### Targeted Destroy

```shell
# Destroy specific resources only
atmos terraform destroy vpc -s dev -target=aws_instance.web
```

## Arguments

<dl>
    <dt>`component` <em>(required)</em></dt>
    <dd>
        Atmos component name.
    </dd>
</dl>

## Flags

<dl>
    <dt>`--stack` / `-s` <em>(required)</em></dt>
    <dd>
        Atmos stack name where the component is defined.
    </dd>

    <dt>`--skip-init` <em>(optional)</em></dt>
    <dd>
        Skip running `terraform init` before executing the command.

        ```shell
        atmos terraform destroy vpc -s dev --skip-init
        ```
    </dd>

    <dt>`--dry-run` <em>(optional)</em></dt>
    <dd>
        Show what would be executed without actually running the command.

        ```shell
        atmos terraform destroy vpc -s dev --dry-run
        ```
    </dd>
</dl>

## Native Terraform Flags

<dl>
    <dt>`-auto-approve`</dt>
    <dd>
        Skip interactive approval before destroying.

        ```shell
        atmos terraform destroy vpc -s dev -auto-approve
        ```

        :::warning
        Use `-auto-approve` with extreme caution, especially in production environments.
        :::
    </dd>

    <dt>`-target=RESOURCE`</dt>
    <dd>
        Destroy only the specified resource. Can be used multiple times.

        ```shell
        atmos terraform destroy vpc -s dev -target=aws_instance.web -target=aws_instance.db
        ```
    </dd>

    <dt>`-parallelism=N`</dt>
    <dd>
        Limit the number of concurrent operations (default: 10).

        ```shell
        atmos terraform destroy vpc -s dev -parallelism=5
        ```
    </dd>
</dl>

## Multi-Component Operations

Execute `terraform destroy` across multiple components using filtering flags. All flags can be combined with `--dry-run` to preview what would be executed.

:::danger
Multi-component destroy operations will destroy infrastructure across multiple components. Always use `--dry-run` first to verify which components will be affected. Consider the reverse dependency order when destroying.
:::

### Destroy All Components

```shell
# Destroy all components in all stacks (use with extreme caution)
atmos terraform destroy --all

# Destroy all components in a specific stack
atmos terraform destroy --all --stack prod
atmos terraform destroy --stack prod
```

### Destroy Affected Components

Destroy only components affected by changes in the current branch (requires git). Components are processed in dependency order:

```shell
# Destroy affected components in all stacks
atmos terraform destroy --affected

# Destroy affected components in a specific stack
atmos terraform destroy --affected --stack prod

# Include dependent components
atmos terraform destroy --affected --include-dependents

# Clone the target reference instead of checking it out
atmos terraform destroy --affected --clone-target-ref=true
```

### Destroy Specific Components

```shell
# Destroy specific components in all stacks
atmos terraform destroy --components vpc,eks

# Destroy specific components in a specific stack
atmos terraform destroy --components vpc,eks --stack prod
```

### Destroy Components by Query

Filter components using [YQ](https://mikefarah.gitbook.io/yq) expressions against component configuration:

```shell
# Destroy components where team tag equals "eks"
atmos terraform destroy --query '.vars.tags.team == "eks"'

# Destroy components in a specific account
atmos terraform destroy --query '.settings.context.account_id == 12345'

# Combine with stack filter
atmos terraform destroy --query '.vars.tags.team == "eks"' --stack prod
```

### Multi-Component Flags

<dl>
    <dt>`--all`</dt>
    <dd>Destroy all components in all stacks (or specified stack with `--stack`).</dd>

    <dt>`--affected`</dt>
    <dd>Destroy components affected by git changes in dependency order. Supports all flags from [`atmos describe affected`](/cli/commands/describe/affected).</dd>

    <dt>`--components`</dt>
    <dd>Destroy specific components by name (comma-separated or repeated flag).</dd>

    <dt>`--query`</dt>
    <dd>Destroy components matching a YQ expression. All Atmos sections are available: `vars`, `settings`, `env`, `metadata`, etc.</dd>

    <dt>`--include-dependents`</dt>
    <dd>With `--affected`, also destroy components that depend on affected components, recursively.</dd>

    <dt>`--ref`</dt>
    <dd>Git reference to compare against (branch or tag). Default: `refs/remotes/origin/HEAD`.</dd>

    <dt>`--sha`</dt>
    <dd>Git commit SHA to compare against.</dd>

    <dt>`--clone-target-ref`</dt>
    <dd>Clone the target reference instead of checking it out locally.</dd>
</dl>

## Related Commands

- [`atmos terraform plan`](/cli/commands/terraform/plan) - Generate execution plan
- [`atmos terraform apply`](/cli/commands/terraform/apply) - Apply changes
- [`atmos terraform init`](/cli/commands/terraform/init) - Initialize working directory
