---
title: Providers
sidebar_position: 2
sidebar_label: providers
sidebar_class_name: command
id: providers
description: Configure authentication providers for AWS SSO, SAML, GitHub OIDC, and GCP Workload Identity Federation in your `atmos.yaml`.
---
import DocCardList from '@theme/DocCardList'
import File from '@site/src/components/File'
import Intro from '@site/src/components/Intro'
import Experimental from '@site/src/components/Experimental'
import Tabs from '@theme/Tabs'
import TabItem from '@theme/TabItem'

<Intro>
Providers are the upstream systems that Atmos uses to obtain initial credentials. Configure providers in the `auth.providers` section of your `atmos.yaml`.
</Intro>

<Experimental />

## AWS IAM Identity Center (SSO)

The most common provider for AWS organizations using SSO.

<File title="atmos.yaml">
```yaml
auth:
  providers:
    company-sso:
      kind: aws/iam-identity-center
      region: us-east-1
      start_url: https://company.awsapps.com/start

      # Automatically discover all accounts and permission sets
      auto_provision_identities: true

      # Optional session configuration
      session:
        duration: 4h               # Credential lifetime

      console:
        session_duration: 12h      # Web console session (max 12h)
```
</File>

<dl>
  <dt>`kind`</dt>
  <dd>**Required.** Must be `aws/iam-identity-center`.</dd>

  <dt>`region`</dt>
  <dd>**Required.** AWS region for the Identity Center instance.</dd>

  <dt>`start_url`</dt>
  <dd>**Required.** Your AWS SSO start URL (e.g., `https://company.awsapps.com/start`).</dd>

  <dt>`auto_provision_identities`</dt>
  <dd>Optional. When `true`, Atmos automatically discovers all AWS accounts and permission sets assigned to the user and creates identities for them. This eliminates the need to manually configure each identity. Default: `false`.</dd>

  <dt>`session.duration`</dt>
  <dd>Optional. Session duration for CLI credentials (e.g., `1h`, `4h`). Default varies by provider.</dd>

  <dt>`console.session_duration`</dt>
  <dd>Optional. Web console session duration. Maximum 12 hours for AWS.</dd>
</dl>

### IAM Permissions for Identity Provisioning

When using automatic identity provisioning (`auto_provision_identities: true`), Atmos queries AWS Identity Center APIs during login to discover available permission sets across assigned accounts. This requires specific IAM permissions.

<details>
<summary>Required IAM Permissions</summary>

#### Basic Provisioning (Required)

These permissions are required for automatic identity provisioning to work:

```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Action": [
        "sso:ListAccounts",
        "sso:ListAccountRoles"
      ],
      "Resource": "*"
    }
  ]
}
```

**APIs Used:**
- `sso:ListAccounts` - Enumerates all AWS accounts the user can access
- `sso:ListAccountRoles` - Lists available permission sets (roles) for each account

#### How to Apply Permissions

These permissions should be attached to the IAM Identity Center permission set that users authenticate with, or to the IAM user/role if using static credentials. Without these permissions, identity provisioning will fail gracefully and fall back to manually configured identities.

</details>

## AWS SAML

For organizations using SAML-based identity providers like Okta, Google Apps, or ADFS.

<File title="atmos.yaml">
```yaml
auth:
  providers:
    okta-saml:
      kind: aws/saml
      region: us-east-1
      url: https://company.okta.com/app/amazon_aws/abc123/sso/saml
      driver: Browser              # Browser, GoogleApps, Okta, or ADFS
```
</File>

<dl>
  <dt>`kind`</dt>
  <dd>**Required.** Must be `aws/saml`.</dd>

  <dt>`region`</dt>
  <dd>**Required.** AWS region.</dd>

  <dt>`url`</dt>
  <dd>**Required.** SAML SSO URL from your identity provider.</dd>

  <dt>`driver`</dt>
  <dd>Optional. Authentication method: `Browser` (default, requires Playwright), `GoogleApps`, `Okta`, or `ADFS`.</dd>
</dl>

:::note
The `aws/saml` provider requires the next identity to be of kind `aws/assume-role`, as the SAML authentication flow requires selecting a role to assume.
:::

## GitHub Actions OIDC

For CI/CD pipelines running in GitHub Actions.

<File title="atmos.yaml">
```yaml
auth:
  providers:
    github-oidc:
      kind: github/oidc
      region: us-east-1            # Required for GitHub OIDC
      spec:
        audience: sts.us-east-1.amazonaws.com
```
</File>

<dl>
  <dt>`kind`</dt>
  <dd>**Required.** Must be `github/oidc`.</dd>

  <dt>`region`</dt>
  <dd>**Required.** AWS region for STS endpoint.</dd>

  <dt>`spec.audience`</dt>
  <dd>Optional. OIDC audience. Defaults to STS endpoint for the region.</dd>
</dl>

## GCP Application Default Credentials

For local development using existing `gcloud` authentication.

<File title="atmos.yaml">
```yaml
auth:
  providers:
    gcp-adc:
      kind: gcp/adc
      project_id: my-gcp-project      # Optional: override default project
      region: us-central1             # Optional: default region
      scopes:                         # Optional: custom OAuth scopes
        - https://www.googleapis.com/auth/cloud-platform
```
</File>

<dl>
  <dt>`kind`</dt>
  <dd>**Required.** Must be `gcp/adc`.</dd>

  <dt>`project_id`</dt>
  <dd>Optional. GCP project ID. If not set, uses the project from `gcloud config`.</dd>

  <dt>`region`</dt>
  <dd>Optional. Default GCP region for resources.</dd>

  <dt>`scopes`</dt>
  <dd>Optional. OAuth scopes for the access token. Defaults to `https://www.googleapis.com/auth/cloud-platform`.</dd>
</dl>

:::note
The `gcp/adc` provider requires existing Application Default Credentials. Run `gcloud auth application-default login` first.
:::

## GCP Workload Identity Federation

For CI/CD pipelines using OIDC tokens (e.g., GitHub Actions).

<File title="atmos.yaml">
```yaml
auth:
  providers:
    gcp-wif:
      kind: gcp/workload-identity-federation
      project_id: my-gcp-project
      project_number: "123456789012"
      workload_identity_pool_id: github-pool
      workload_identity_provider_id: github-provider
      service_account_email: ci-sa@my-project.iam.gserviceaccount.com
      token_source:
        type: url                     # GitHub Actions OIDC
```
</File>

<dl>
  <dt>`kind`</dt>
  <dd>**Required.** Must be `gcp/workload-identity-federation`.</dd>

  <dt>`project_id`</dt>
  <dd>Optional. GCP project ID for the resulting credentials.</dd>

  <dt>`project_number`</dt>
  <dd>**Required.** GCP project number (numeric) where WIF is configured.</dd>

  <dt>`workload_identity_pool_id`</dt>
  <dd>**Required.** Workload Identity Pool ID.</dd>

  <dt>`workload_identity_provider_id`</dt>
  <dd>**Required.** Workload Identity Provider ID within the pool.</dd>

  <dt>`service_account_email`</dt>
  <dd>Optional. Service account to impersonate after federation. If not set, uses the federated token directly.</dd>

  <dt>`token_source.type`</dt>
  <dd>**Required.** Token source type: `url` (GitHub Actions), `file`, or `environment`.</dd>

  <dt>`token_source.environment_variable`</dt>
  <dd>For `type: environment`. Environment variable containing the OIDC token.</dd>

  <dt>`token_source.file_path`</dt>
  <dd>For `type: file`. Path to file containing the OIDC token.</dd>

  <dt>`token_source.url`</dt>
  <dd>For `type: url`. URL to fetch OIDC token. Defaults to GitHub Actions OIDC endpoint.</dd>

  <dt>`token_source.request_token`</dt>
  <dd>For `type: url`. Bearer token for authenticating to the OIDC token endpoint. For GitHub Actions, this is automatically populated from `ACTIONS_ID_TOKEN_REQUEST_TOKEN`. Required for non-GitHub OIDC providers.</dd>

  <dt>`token_source.audience`</dt>
  <dd>Optional. Audience for the OIDC token request.</dd>

  <dt>`scopes`</dt>
  <dd>Optional. OAuth scopes for the access token.</dd>
</dl>

### GitHub Actions Setup

For GitHub Actions, use `type: url` which automatically uses the `ACTIONS_ID_TOKEN_REQUEST_URL` and `ACTIONS_ID_TOKEN_REQUEST_TOKEN` environment variables:

<File title=".github/workflows/deploy.yaml">
```yaml
jobs:
  deploy:
    permissions:
      id-token: write    # Required for OIDC
      contents: read
    steps:
      - uses: actions/checkout@v4
      - name: Deploy with Atmos
        run: atmos terraform apply mycomponent -s prod
```
</File>

## Multiple Providers

You can configure multiple providers for different use cases and cloud platforms:

<File title="atmos.yaml">
```yaml
auth:
  providers:
    # AWS SSO for interactive use
    company-sso:
      kind: aws/iam-identity-center
      region: us-east-1
      start_url: https://company.awsapps.com/start

    # AWS GitHub OIDC for CI/CD
    aws-github-oidc:
      kind: github/oidc
      region: us-east-1

    # GCP local development
    gcp-adc:
      kind: gcp/adc

    # GCP GitHub Actions
    gcp-wif:
      kind: gcp/workload-identity-federation
      project_number: "123456789012"
      workload_identity_pool_id: github-pool
      workload_identity_provider_id: github-provider
      token_source:
        type: url
```
</File>

Each provider can be referenced by name in identity configurations using the `via.provider` field.

## Using Profiles for Different Environments

Use [Atmos profiles](/cli/configuration/profiles) to swap provider implementations while keeping the same provider name. This allows your identities to reference a single provider (e.g., `acme-corp`) that behaves differently depending on the active profile:

- **Developers** authenticate via SSO in their browser
- **CI/CD pipelines** authenticate via GitHub OIDC tokens
- **Platform engineers** use SSO with extended session durations

Because the provider name stays consistent, your identity configurations work unchanged across all environments.

Create a directory for each profile:

```
profiles/
├── dev/
│   └── auth.yaml
├── ci/
│   └── auth.yaml
└── platform/
    └── auth.yaml
```

<Tabs>
<TabItem value="dev" label="profiles/dev/auth.yaml">
```yaml
# Profile for local development (SSO)
auth:
  providers:
    acme-corp:
      kind: aws/iam-identity-center
      region: us-east-1
      start_url: https://acme.awsapps.com/start
```
</TabItem>
<TabItem value="ci" label="profiles/ci/auth.yaml">
```yaml
# Profile for CI/CD pipelines (OIDC)
auth:
  providers:
    acme-corp:
      kind: github/oidc
      region: us-east-1
```
</TabItem>
<TabItem value="platform" label="profiles/platform/auth.yaml">
```yaml
# Profile for platform engineers (SSO with extended sessions)
auth:
  providers:
    acme-corp:
      kind: aws/iam-identity-center
      region: us-east-1
      start_url: https://acme.awsapps.com/start
      session:
        duration: 8h
```
</TabItem>
</Tabs>

Activate a profile with `--profile` or the `ATMOS_PROFILE` environment variable:

```bash
# Use the CI profile in GitHub Actions
ATMOS_PROFILE=ci atmos terraform apply myapp -s prod

# Use the platform profile for extended sessions
atmos --profile platform auth login
```

## Related Commands

<DocCardList items={[
  {type: 'link', href: '/cli/commands/auth/login', label: 'atmos auth login', description: 'Authenticate with a configured provider'},
  {type: 'link', href: '/cli/commands/auth/validate', label: 'atmos auth validate', description: 'Validate provider configuration'},
  {type: 'link', href: '/cli/commands/auth/console', label: 'atmos auth console', description: 'Open AWS console in browser'},
  {type: 'link', href: '/cli/commands/auth/list', label: 'atmos auth list', description: 'List available identities and providers'},
]} />

## See Also

- [Identities](/cli/configuration/auth/identities) — Configure identities that use these providers
- [Profiles](/cli/configuration/profiles) — Environment-specific configuration overrides
