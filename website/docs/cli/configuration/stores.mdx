---
title: Stores Configuration
sidebar_label: stores
sidebar_class_name: command
id: stores
description: Configure external stores for sharing data between components in atmos.yaml.
---
import File from '@site/src/components/File'
import Intro from '@site/src/components/Intro'

<Intro>
The `stores` section in `atmos.yaml` configures external key-value stores that can be used to share data between components using the [`!store`](/stacks/sharing-state/stores) YAML function and [hooks](/stacks/hooks).
</Intro>

## Configuration

<File title="atmos.yaml">
```yaml
stores:
  # AWS SSM Parameter Store
  prod/ssm:
    type: aws-ssm-parameter-store
    options:
      region: us-east-1

  # Azure Key Vault
  prod/azure:
    type: azure-key-vault
    options:
      vault_url: "https://my-keyvault.vault.azure.net/"

  # Google Secret Manager
  prod/gcp:
    type: google-secret-manager
    options:
      project_id: my-project

  # Redis
  cache:
    type: redis
    options:
      url: "redis://localhost:6379"

  # Artifactory
  artifacts:
    type: artifactory
    options:
      url: https://artifactory.example.com
      repo_name: my-repo
```
</File>

## Store Name Convention

Store names follow the pattern `<environment>/<type>` by convention:
- `prod/ssm` - Production SSM Parameter Store
- `dev/secrets` - Development Secrets Manager
- `shared/config` - Shared configuration store

You can reference stores in stack configuration using the `!store` function:

```yaml
vars:
  database_password: !store prod/secrets::database/password
  api_key: !store prod/ssm::/app/api-key
```

## Supported Store Types

<dl>
  <dt>`aws-ssm-parameter-store`</dt>
  <dd>AWS Systems Manager Parameter Store. Stores and retrieves parameters from SSM.</dd>

  <dt>`azure-key-vault`</dt>
  <dd>Azure Key Vault. Stores and retrieves secrets from Azure.</dd>

  <dt>`google-secret-manager` (or `gsm`)</dt>
  <dd>Google Cloud Secret Manager. Stores and retrieves secrets from GCP.</dd>

  <dt>`redis`</dt>
  <dd>Redis key-value store. Useful for caching and temporary data.</dd>

  <dt>`artifactory`</dt>
  <dd>JFrog Artifactory. Stores and retrieves artifacts and metadata.</dd>
</dl>

## Store Type Configuration

### AWS SSM Parameter Store

<File title="atmos.yaml">
```yaml
stores:
  prod/ssm:
    type: aws-ssm-parameter-store
    options:
      region: us-east-1
      # Optional
      prefix: myapp
      stack_delimiter: "/"
      # Optional: assume role for cross-account access
      read_role_arn: arn:aws:iam::123456789012:role/SSMReader
      write_role_arn: arn:aws:iam::123456789012:role/SSMWriter
```
</File>

### Azure Key Vault

<File title="atmos.yaml">
```yaml
stores:
  prod/azure:
    type: azure-key-vault
    options:
      vault_url: "https://my-keyvault.vault.azure.net/"
      # Optional
      prefix: myapp
      stack_delimiter: "-"
```
</File>

Authentication uses the [Azure Default Credential chain](https://learn.microsoft.com/en-us/azure/developer/go/azure-sdk-authentication), which checks environment variables, managed identity, Azure CLI, and other sources.

### Google Secret Manager

<File title="atmos.yaml">
```yaml
stores:
  prod/gcp:
    type: google-secret-manager  # or "gsm"
    options:
      project_id: my-project
      # Optional
      prefix: myapp
      stack_delimiter: "_"
      # Optional: JSON credentials (or use GOOGLE_APPLICATION_CREDENTIALS env var)
      credentials: '{"type":"service_account",...}'
      # Optional: replication locations
      locations:
        - us-east1
        - us-west1
```
</File>

### Redis

<File title="atmos.yaml">
```yaml
stores:
  cache:
    type: redis
    options:
      url: "redis://localhost:6379"  # or use ATMOS_REDIS_URL env var
      # Optional
      prefix: myapp
      stack_delimiter: "/"
```
</File>

The `url` option supports Redis URL format including authentication: `redis://:password@host:port/db`

### Artifactory

<File title="atmos.yaml">
```yaml
stores:
  artifacts:
    type: artifactory
    options:
      url: https://artifactory.example.com
      repo_name: my-repo
      # Optional: access token (or use ARTIFACTORY_ACCESS_TOKEN env var)
      access_token: "..."
      # Optional
      prefix: myapp
      stack_delimiter: "/"
```
</File>

## Using Stores in Hooks

You can write values to stores using [hooks](/stacks/hooks):

```yaml
components:
  terraform:
    vpc:
      hooks:
        store-outputs:
          events:
            - after-terraform-apply
          command: store
          name: prod/ssm
          outputs:
            - vpc_id
            - subnet_ids
```

This writes Terraform outputs to the configured store after apply completes.

## Related

- [External Stores](/stacks/sharing-state/stores) - Using `!store` function in stacks
- [Hooks](/stacks/hooks) - Writing to stores with hooks
- [Terraform State](/stacks/sharing-state/terraform-state) - Alternative data sharing method
