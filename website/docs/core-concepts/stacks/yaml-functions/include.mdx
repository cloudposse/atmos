---
title: "!include"
sidebar_position: 6
sidebar_label: "!include"
description: Download local or remote files from different sources, and assign the file contents or individual values to Atmos stack manifests
---

import Intro from '@site/src/components/Intro'

<Intro>
    The `!include` Atmos YAML function allows downloading local or remote files from different sources,
    and assigning the file contents or individual values to the sections in Atmos stack manifests.
</Intro>

## Usage

The `!include` function can be called with either one or two parameters:

```yaml
  # Download the file and assign its content to the variable
  var1: !include <file-path>

  # Download the file, filter the content using the YQ expression,
  # and assign the result to the variable
  var2: !include <file-path> <yq-expression>
```

## Arguments

<dl>
    <dt>`file-path`</dt>
    <dd>
        Path to a local or remote file
    </dd>

    <dt>`yq-expression`</dt>
    <dd>(Optional) [YQ](https://mikefarah.gitbook.io/yq) expression to retrieve individual values from the file</dd>
</dl>

## Examples

```yaml
components:
  terraform:
    my-component:
      settings:
        config:
          user_id: !include ./user_config.json .user_id
      vars:
        values: !include ./values.yaml
        ipv4_primary_cidr_block: !include ./vpc_config.yaml .vars.ipv4_primary_cidr_block
        vpc_defaults: !include stacks/catalog/vpc/defaults.yaml
        hcl_values: !include ./values.hcl
        tfvars_values: !include ../components/terraform/vpc/vpc.tfvars
        description: !include ./description.md
        text: !include a.txt
        text2: !include '"b c.txt" .[1]'
        tests: !include '"~/My Documents/dev/tests.yaml" .config.tests'
        region_values: !include https://raw.githubusercontent.com/cloudposse/atmos/refs/heads/main/examples/quick-start-advanced/stacks/mixins/region/us-east-2.yaml .vars
        allowed_ips: !include https://api.github.com/meta .api
```

## Description

The YAML standard provides [anchors and aliases](https://yaml.org/spec/1.2.2/#3222-anchors-and-aliases), that allow you
to reuse and reference pieces of your YAML file, making it more efficient and reducing duplication.

Atmos supports YAML anchors and aliases, but the biggest limitation is that they are only available within the file in
which they are defined. You cannot reuse anchors across different files.

The `!include` Atmos YAML function overcomes this limitation by allowing you to include the content or individual values
from different local and remote sources.

## Supported File Protocols

The `!include` function supports the following local file paths:
  - absolute paths (e.g. `/Users/me/Documents/values.yaml`)
  - paths relative to the current Atmos manifest where the `!include` function is executed (e.g. `./values.yaml`, `../config/values.yaml`)
  - paths relative to the [`base_path`](/cli/configuration/#base-path) defined in `atmos.yaml` CLI config file (e.g. `stacks/catalog/vpc/defaults.yaml`)

To download remote files from different sources, the `!include` function uses [`go-getter`](https://github.com/hashicorp/go-getter)
(used by [Terraform](https://www.terraform.io/) for downloading modules) and supports the following protocols:

- `tar` - Tar files, potentially compressed (tar.gz, tar.bz2, etc.)
- `zip` - Zip files
- `http` - HTTP URLs
- `https` - HTTPS URLs
- `git` - Git repositories, which can be accessed via HTTPS or SSH
- `hg` - Mercurial repositories, accessed via HTTP/S or SSH
- `s3` - Amazon S3 bucket URLs
- `gcs` - Google Cloud Storage URLs
- `oci` - Open Container Initiative (OCI) images
- `scp` - Secure Copy Protocol for SSH-based transfers
- `sftp` - SSH File Transfer Protocol

:::tip
You can use [Atmos Stack Manifest Templating](/core-concepts/stacks/templates) in the `!include` YAML function parameters.
Atmos processes the templates first, and then executes the `!include` function, allowing you to provide the parameters to
the function dynamically.
:::

## Using YQ Expressions to retrieve individual values from files

To retrieve individual values from complex types such as maps and lists, or do any kind of filtering or querying,
you can utilize [YQ](https://mikefarah.gitbook.io/yq) expressions.

For example:

- Retrieve the first item from a list

```yaml
subnet_id1: !include <file-path> .private_subnet_ids[0]
```

- Read a key from a map

```yaml
username: !include <file-path> .config_map.username
```

For more details, review the following docs:

- [YQ Guide](https://mikefarah.gitbook.io/yq)
- [YQ Recipes](https://mikefarah.gitbook.io/yq/recipes)

## Handling file paths and YQ expressions with spaces

If you have spaces in the file names or the YQ expressions, enclose the file path and YQ expression in double quotes and
the whole expression in single quotes.

For example, on Windows:

```yaml
  vars:
    values: !include '"~/My Documents/dev/values.yaml"'
    config: !include '"~/My Documents/dev/config.json" "<yq-expression-with-spaces>"'
```

On macOS and Linux:

```yaml
  vars:
    values: !include './values.yaml "<yq-expression-with-spaces>"'
    description: !include '"component description.md"'
```
