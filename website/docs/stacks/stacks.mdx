---
title: Stack Configuration
sidebar_position: 1
sidebar_label: Overview
sidebar_class_name: hidden
description: Advanced stack configuration techniques
id: stacks
slug: /stacks
---
import Intro from '@site/src/components/Intro'
import DocCardList from '@theme/DocCardList'

<Intro>
Stacks are configuration files that define your environments. They specify which components to deploy, with what settings, and how they relate to each other. This is where configuration livesâ€”separate from your Terraform code. Write stacks in YAML, JSON, or HCL.
</Intro>

## Example

A typical stack configuration imports reusable defaults from a catalog and defines environment-specific components:

```yaml title="stacks/production.yaml" stack-example
import:
  - catalog/vpc/defaults
  - catalog/eks/defaults

vars:
  environment: production
  region: us-east-2

components:
  terraform:
    vpc:
      vars:
        cidr_block: "10.0.0.0/16"
        availability_zones:
          - us-east-2a
          - us-east-2b
    eks:
      metadata:
        component: eks/cluster
      vars:
        cluster_name: production
        node_count: 3
```

## Multi-Stack Files

YAML files can contain multiple stacks separated by `---`. Each stack can have an explicit `name` field to identify it:

```yaml title="stacks/environments.yaml" stack-example
name: dev
vars:
  environment: development
components:
  terraform:
    vpc:
      vars:
        cidr_block: "10.1.0.0/16"
---
name: staging
vars:
  environment: staging
components:
  terraform:
    vpc:
      vars:
        cidr_block: "10.2.0.0/16"
```

This approach is useful for managing related environments together or for organizing stacks by team or project.

## Configuration Sections

Stack manifests support various configuration sections at different scopes:

| Section | Description | Scopes |
|---------|-------------|--------|
| [name](/stacks/name) | Explicit stack name override | Stack manifest only |
| [vars](/stacks/vars) | Variables passed to components | Global, component-type, component |
| [locals](/stacks/locals) | File-scoped temporary variables | Global, component-type, component |
| [env](/stacks/env) | Environment variables | Global, component-type, component |
| [settings](/stacks/settings) | Integrations and metadata | Global, component-type, component |
| [metadata](/stacks/components/component-metadata) | Component behavior and inheritance | Component only |
| [hooks](/stacks/hooks) | Lifecycle event handlers | Global, component-type, component |
| [command](/stacks/command) | Override default executable | Component-type, component |
| [backend](/stacks/backend) | Terraform state storage | Component-type, component |
| [providers](/stacks/providers) | Terraform provider configuration | Component-type, component |
| [auth](/stacks/auth) | Authentication configuration | Global (atmos.yaml), component |

## Component Types

Atmos supports three component types, each with specific configuration options:

| Type | Purpose | Documentation |
|------|---------|---------------|
| [Terraform](/stacks/components/terraform) | Infrastructure as Code | Cloud resources, networking, IAM |
| [Helmfile](/stacks/components/helmfile) | Kubernetes deployments | Helm chart releases |
| [Packer](/stacks/components/packer) | Machine image building | AMIs, VM images |

## Composition and Reuse

Build maintainable configurations using these patterns:

| Pattern | Description |
|---------|-------------|
| [Imports](/stacks/imports) | Include configuration from other files |
| [Catalogs](/howto/catalogs) | Reusable component configurations |
| [Inheritance](/howto/inheritance) | Inherit settings between components |
| [Overrides](/stacks/overrides) | Override inherited configuration |
| [Mixins](/howto/mixins) | Composable configuration snippets |
| [depends_on](/stacks/settings/depends_on) | Define component dependencies |

## Sharing State

Share data between components and stacks:

| Topic | Description |
|-------|-------------|
| [Remote State](/stacks/remote-state) | Access Terraform state from other components |
| [Share Data](/stacks/share-data) | Share configuration between components |

## Describing Stacks

Use [`atmos describe stacks`](/cli/commands/describe/stacks) to view the fully computed, deep-merged configuration of any stack. This is invaluable for debugging and understanding what configuration will actually be applied.

```bash
# View all stacks
atmos describe stacks

# Filter by specific stack
atmos describe stacks --stack plat-ue2-prod

# Filter by component and section
atmos describe stacks --components vpc --sections vars

# Output as JSON for processing with jq
atmos describe stacks --format json | jq '.["plat-ue2-prod"]'
```

The output shows the final resolved configuration after all imports, inheritance, and overrides have been applied. Use `--sections` to filter output to specific sections like `vars`, `env`, `settings`, `metadata`, `backend`, or `workspace`.

<DocCardList />
