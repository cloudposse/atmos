Atmos supports 25+ step types across five categories: Command, Interactive, UI Messages, Output, and Terminal. These step types enable building sophisticated CLI wizards and interactive deployment pipelines.

### Step Types Overview

| Category | Step Types | Description |
|----------|------------|-------------|
| **Command** | `atmos`, `shell` | Execute Atmos or shell commands |
| **Interactive** | `input`, `confirm`, `choose`, `filter`, `file`, `write` | Collect user input |
| **UI Messages** | `success`, `info`, `warn`, `error`, `markdown` | Display formatted messages |
| **Output** | `spin`, `table`, `pager`, `format`, `join`, `style` | Format and display output |
| **Terminal** | `alert`, `title`, `clear`, `env`, `exit` | Terminal control and workflow management |

### Interactive Step Types

Interactive steps require a TTY (terminal) to run. In CI environments, use `--dry-run` to preview workflows or set default values.

#### input

Prompts for single-line text input.

```yaml
steps:
  - name: message
    type: input
    prompt: "Enter deployment message"
    placeholder: "e.g., Fix for ticket JIRA-123"
    default: "Routine deployment"
```

<dl>
  <dt>`prompt`</dt>
  <dd>The prompt text to display</dd>

  <dt>`default`</dt>
  <dd>Default value if user presses enter</dd>

  <dt>`placeholder`</dt>
  <dd>Placeholder text shown in the input field</dd>

  <dt>`password`</dt>
  <dd>Set to `true` to mask input for sensitive values</dd>
</dl>

#### confirm

Prompts for yes/no confirmation.

```yaml
steps:
  - name: confirm_prod
    type: confirm
    prompt: "Deploy to production?"
    default: false
```

<dl>
  <dt>`prompt`</dt>
  <dd>The confirmation question</dd>

  <dt>`default`</dt>
  <dd>Default value (`true` or `false`)</dd>
</dl>

#### choose

Single selection from a list of options.

```yaml
steps:
  - name: environment
    type: choose
    prompt: "Select target environment"
    options:
      - dev
      - staging
      - prod
    default: dev
```

<dl>
  <dt>`prompt`</dt>
  <dd>The selection prompt</dd>

  <dt>`options`</dt>
  <dd>List of options to choose from</dd>

  <dt>`default`</dt>
  <dd>Default selected option</dd>
</dl>

#### filter

Filterable selection with optional multi-select support.

```yaml
steps:
  - name: components
    type: filter
    prompt: "Select components to deploy"
    multiple: true
    limit: 5
    options:
      - vpc
      - eks
      - rds
      - s3
      - lambda
```

<dl>
  <dt>`prompt`</dt>
  <dd>The selection prompt</dd>

  <dt>`options`</dt>
  <dd>List of options to filter/select from</dd>

  <dt>`multiple`</dt>
  <dd>Allow multiple selections (default: `false`)</dd>

  <dt>`limit`</dt>
  <dd>Maximum number of visible options</dd>
</dl>

:::tip
Use `{{ .steps.NAME.values }}` to access the array of selected values when `multiple: true`.
:::

#### file

File picker for selecting files from the filesystem.

```yaml
steps:
  - name: config_file
    type: file
    prompt: "Select a configuration file"
    path: "./configs"
    extensions:
      - yaml
      - yml
      - json
```

<dl>
  <dt>`prompt`</dt>
  <dd>The file selection prompt</dd>

  <dt>`path`</dt>
  <dd>Starting directory for file browsing</dd>

  <dt>`extensions`</dt>
  <dd>List of allowed file extensions</dd>
</dl>

#### write

Multi-line text editor for longer input.

```yaml
steps:
  - name: notes
    type: write
    prompt: "Enter deployment notes"
    placeholder: |
      Describe the changes being deployed...

      - Change 1
      - Change 2
```

<dl>
  <dt>`prompt`</dt>
  <dd>The editor prompt</dd>

  <dt>`placeholder`</dt>
  <dd>Placeholder text shown in the editor</dd>
</dl>

### UI Message Step Types

These steps display formatted messages to the user. They use the Atmos UI theme for consistent styling.

#### success

Displays a success message with a green checkmark icon.

```yaml
steps:
  - name: done
    type: success
    content: "Deployment completed successfully!"
```

#### info

Displays an informational message with a blue info icon.

```yaml
steps:
  - name: status
    type: info
    content: "Processing {{ .steps.count.value }} items..."
```

#### warn

Displays a warning message with a yellow warning icon.

```yaml
steps:
  - name: caution
    type: warn
    content: "This action cannot be undone!"
```

#### error

Displays an error message with a red error icon.

```yaml
steps:
  - name: failed
    type: error
    content: "Configuration validation failed"
```

#### markdown

Renders markdown content with full formatting support.

```yaml
steps:
  - name: intro
    type: markdown
    content: |
      # Deployment Wizard

      Welcome to the interactive deployment workflow!

      This wizard will guide you through:
      - **Environment selection**
      - **Component configuration**
      - **Deployment verification**
```

<dl>
  <dt>`content`</dt>
  <dd>Markdown content to render. Supports Go templates for dynamic content.</dd>
</dl>

### Output Step Types

#### spin

Displays a spinner while executing a command.

```yaml
steps:
  - name: building
    type: spin
    title: "Building application..."
    command: "npm run build"
    timeout: 60s
```

<dl>
  <dt>`title`</dt>
  <dd>Text displayed next to the spinner</dd>

  <dt>`command`</dt>
  <dd>Shell command to execute</dd>

  <dt>`timeout`</dt>
  <dd>Maximum time for command execution (e.g., `30s`, `5m`)</dd>
</dl>

#### table

Displays data in a formatted table.

```yaml
steps:
  - name: environments
    type: table
    title: "Available Environments"
    columns:
      - name
      - region
      - status
    data:
      - name: dev
        region: us-east-1
        status: active
      - name: staging
        region: us-west-2
        status: active
```

<dl>
  <dt>`title`</dt>
  <dd>Table title</dd>

  <dt>`columns`</dt>
  <dd>List of column names</dd>

  <dt>`data`</dt>
  <dd>Array of row objects with values for each column</dd>
</dl>

#### join

Joins multiple strings together with a separator.

```yaml
steps:
  - name: combined
    type: join
    separator: ", "
    options:
      - "{{ .steps.header.value }}"
      - "{{ .steps.body.value }}"
      - "{{ .steps.footer.value }}"
```

<dl>
  <dt>`options`</dt>
  <dd>Array of strings to join (supports templates)</dd>

  <dt>`separator`</dt>
  <dd>String to join values with (default: newline)</dd>

  <dt>`content`</dt>
  <dd>Alternative: single template string to resolve and return as-is</dd>
</dl>

#### pager

Displays content in a scrollable pager.

```yaml
steps:
  - name: show_logs
    type: pager
    title: "Build Logs"
    content: "{{ .steps.build.metadata.stdout }}"
```

Or load from a file:

```yaml
steps:
  - name: show_readme
    type: pager
    title: "README"
    path: "./README.md"
    markdown: true
```

<dl>
  <dt>`title`</dt>
  <dd>Title displayed at the top of the pager</dd>

  <dt>`content`</dt>
  <dd>Content to display (supports templates)</dd>

  <dt>`path`</dt>
  <dd>Path to file to display (alternative to content)</dd>

  <dt>`markdown`</dt>
  <dd>Render content as markdown (default: auto-detect from .md/.markdown extension)</dd>
</dl>

#### format

Formats and outputs text using Go templates.

```yaml
steps:
  - name: summary
    type: format
    content: |
      Environment: {{ .steps.env.value }}
      Components: {{ .steps.components.values | join ", " }}
```

<dl>
  <dt>`content`</dt>
  <dd>Go template string to render and output</dd>
</dl>

#### style

Applies terminal styling to content using lipgloss.

```yaml
steps:
  - name: banner
    type: style
    content: "Deployment Complete"
    foreground: "#00ff00"
    border: rounded
    padding: "1 2"
    bold: true
```

<dl>
  <dt>`content`</dt>
  <dd>Text to style (supports templates)</dd>

  <dt>`foreground`</dt>
  <dd>Text color (hex or named)</dd>

  <dt>`background`</dt>
  <dd>Background color (hex or named)</dd>

  <dt>`border`</dt>
  <dd>Border style: `normal`, `rounded`, `thick`, `double`, `hidden`</dd>

  <dt>`border_foreground`</dt>
  <dd>Border color</dd>

  <dt>`padding`</dt>
  <dd>Padding (CSS-like: `"1"`, `"1 2"`, `"1 2 1 2"`)</dd>

  <dt>`margin`</dt>
  <dd>Margin (CSS-like format)</dd>

  <dt>`width`</dt>
  <dd>Fixed width in characters</dd>

  <dt>`height`</dt>
  <dd>Fixed height in lines</dd>

  <dt>`align`</dt>
  <dd>Text alignment: `left`, `center`, `right`</dd>

  <dt>`bold`</dt>
  <dd>Bold text</dd>

  <dt>`italic`</dt>
  <dd>Italic text</dd>

  <dt>`underline`</dt>
  <dd>Underlined text</dd>

  <dt>`strikethrough`</dt>
  <dd>Strikethrough text</dd>

  <dt>`faint`</dt>
  <dd>Dimmed text</dd>

  <dt>`markdown`</dt>
  <dd>Render content as markdown before styling</dd>
</dl>

#### linebreak

Outputs blank lines for visual spacing.

```yaml
steps:
  - name: spacer
    type: linebreak
    count: 2
```

<dl>
  <dt>`count`</dt>
  <dd>Number of blank lines to output (default: 1)</dd>
</dl>

#### log

Outputs structured log messages at various levels.

```yaml
steps:
  - name: debug_info
    type: log
    level: debug
    content: "Processing component"
    fields:
      component: "{{ .steps.select.value }}"
      stack: "{{ .env.ATMOS_STACK }}"
```

<dl>
  <dt>`level`</dt>
  <dd>Log level: `trace`, `debug`, `info`, `warn`, `error`</dd>

  <dt>`content`</dt>
  <dd>Log message (supports templates)</dd>

  <dt>`fields`</dt>
  <dd>Structured key-value pairs to include</dd>
</dl>

### Terminal Step Types

Terminal step types control the terminal environment and workflow execution flow.

#### alert

Plays a terminal bell sound to notify the user. Useful at the end of long-running workflows.

```yaml
steps:
  - name: notify
    type: alert
    content: "Workflow complete!"  # Optional message
```

<dl>
  <dt>`content`</dt>
  <dd>Optional message to display after the bell (supports templates)</dd>
</dl>

:::tip
Use `alert` at the end of long-running workflows to notify users when the workflow completes, even if they've switched to another window.
:::

#### title

Sets the terminal window title. Useful for showing workflow progress in the title bar.

```yaml
steps:
  - name: set_title
    type: title
    content: "Deploying to {{ .steps.env.value }}..."

  - name: deploy
    type: atmos
    command: terraform apply vpc

  - name: restore_title
    type: title  # Empty content restores original title
```

<dl>
  <dt>`content`</dt>
  <dd>Title text (supports templates). If empty, restores the original title.</dd>
</dl>

:::note
Respects `settings.terminal.title` configuration. Some terminals may not support title changes.
:::

#### clear

Clears the current terminal line. Useful for cleaning up dynamic output.

```yaml
steps:
  - name: clear_line
    type: clear
```

No parameters required.

#### env

Sets environment variables for subsequent steps in the workflow.

```yaml
steps:
  - name: get_env
    type: choose
    prompt: "Select environment"
    options: [dev, staging, prod]

  - name: set_env
    type: env
    vars:
      DEPLOY_ENV: "{{ .steps.get_env.value }}"
      AWS_REGION: us-east-1
      TF_VAR_environment: "{{ .steps.get_env.value }}"

  - name: deploy
    type: atmos
    command: terraform apply vpc
```

<dl>
  <dt>`vars`</dt>
  <dd>Map of environment variable names to values (supports templates)</dd>
</dl>

:::tip
Use `env` to pass user input or computed values to subsequent shell/atmos commands as environment variables.
:::

#### exit

Exits the workflow immediately with a specific exit code.

```yaml
steps:
  - name: confirm
    type: confirm
    prompt: "Continue with deployment?"

  - name: abort
    type: exit
    code: 1
    content: "Deployment cancelled by user"
```

<dl>
  <dt>`code`</dt>
  <dd>Exit code (default: 0). Use non-zero for error conditions.</dd>

  <dt>`content`</dt>
  <dd>Optional message to display before exiting (supports templates)</dd>
</dl>

:::warning
The `exit` step immediately terminates the workflow. No subsequent steps will run.
:::

### Variable Passing Between Steps

Steps can access previous step results using Go templates. Each step result is stored in `.steps.<name>`.

<dl>
  <dt>`{{ .steps.<name>.value }}`</dt>
  <dd>Primary value from the step (string)</dd>

  <dt>`{{ .steps.<name>.values }}`</dt>
  <dd>Array of values (for multi-select steps)</dd>

  <dt>`{{ .steps.<name>.metadata.<key> }}`</dt>
  <dd>Metadata like `exit_code`, `stdout`, `stderr`</dd>

  <dt>`{{ .steps.<name>.skipped }}`</dt>
  <dd>Whether the step was skipped</dd>

  <dt>`{{ .steps.<name>.error }}`</dt>
  <dd>Error message if the step failed</dd>

  <dt>`{{ .env.<VAR> }}`</dt>
  <dd>Environment variables</dd>
</dl>

### Output Modes

Control how command output is displayed using the `output` field at the workflow or step level.

```yaml
workflows:
  verbose-deploy:
    output: log  # Workflow-level default
    steps:
      - name: plan
        type: atmos
        command: terraform plan vpc
        output: viewport  # Step-level override
```

<dl>
  <dt>`viewport`</dt>
  <dd>Display output in a scrollable pager</dd>

  <dt>`raw`</dt>
  <dd>Direct passthrough to terminal (default)</dd>

  <dt>`log`</dt>
  <dd>Grouped output with step headers</dd>

  <dt>`none`</dt>
  <dd>Suppress output (check exit code only)</dd>
</dl>

### Show Configuration

Control automatic formatting and progress display using the `show` field at the workflow or step level. All options default to `false` (opt-in).

```yaml
workflows:
  verbose-deploy:
    description: Deploy with full visibility
    show:
      header: true    # Display workflow description as styled header
      flags: true     # Show command-line flags (stack, identity, etc.)
      count: true     # Show step count prefix [1/5]
      command: true   # Show step command before execution
      progress: true  # Show progress bar (TTY only)
    steps:
      - name: plan
        type: atmos
        command: terraform plan vpc
        show:
          command: false  # Override: don't show command for this step
```

<dl>
  <dt>`header`</dt>
  <dd>Display the workflow description as a styled header before the first step executes</dd>

  <dt>`flags`</dt>
  <dd>Show command-line flag values under the header (e.g., `stack: dev`, `identity: prod-admin`)</dd>

  <dt>`command`</dt>
  <dd>Show each step's command before execution with a `$` prefix for shell-like appearance</dd>

  <dt>`count`</dt>
  <dd>Show step count prefix (e.g., `[1/5]`) in step headers</dd>

  <dt>`progress`</dt>
  <dd>Show a right-aligned progress bar during execution (Docker-build style, TTY only)</dd>
</dl>

Step-level `show` settings override workflow-level defaults via deep merge. Only set fields are overridden; unset fields inherit from the workflow.

### TTY Requirements

Interactive steps require a terminal (TTY) to function. In non-interactive environments like CI/CD:

- Use `--dry-run` to preview workflow steps without execution
- Set default values in your workflow configuration
- Use environment variables instead of interactive prompts
- Consider using conditional logic to skip interactive steps in CI
- The `progress` show option only renders in TTY mode
