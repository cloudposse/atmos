---
title: "!aws.region"
sidebar_position: 14
sidebar_label: "!aws.region"
sidebar_class_name: command
description: Retrieve the current AWS region from the SDK configuration
---

import File from '@site/src/components/File'
import Intro from '@site/src/components/Intro'

<Intro>
The `!aws.region` YAML function retrieves the AWS region from the current SDK configuration.
This is the region that would be used for AWS API calls.
</Intro>

## Usage

The `!aws.region` function takes no parameters:

```yaml
  # Get the current AWS region
  region: !aws.region
```

## Arguments

This function takes no arguments. It uses the AWS credentials and configuration from the environment
or the Atmos authentication context if configured.

## How It Works

When processing the `!aws.region` YAML function, Atmos:

1. **Loads AWS Configuration** - Uses the standard AWS SDK configuration resolution:
   - Environment variables (`AWS_REGION`, `AWS_DEFAULT_REGION`)
   - Shared config file (`~/.aws/config`)
   - Instance metadata (for EC2/ECS)
   - Atmos auth context if configured

2. **Returns Region** - Extracts and returns the configured region as a string

:::note Atmos Auth Integration
When using [Atmos Authentication](/cli/commands/auth/usage), the function uses the region from
the active identity if specified. Otherwise, it falls back to the standard AWS SDK resolution.
:::

## Caching

The `!aws.region` function shares its cache with other AWS identity functions
(`!aws.account_id`, `!aws.caller_identity_arn`, `!aws.caller_identity_user_id`). This means:

- All AWS identity functions share a single STS API call
- Results are cached per CLI invocation
- Different authentication contexts get separate cache entries

:::note Type-Aware Merging
Atmos supports type-aware merging of YAML functions and concrete values, allowing them to coexist in the inheritance chain without type conflicts.
See the full explanation: [YAML Function Merging](/reference/yaml-function-merging)
:::

## Examples

### Basic Usage

<File title="stack.yaml">
```yaml
components:
  terraform:
    my-component:
      vars:
        # Inject the AWS region into Terraform variables
        aws_region: !aws.region
```
</File>

### Provider Configuration

<File title="stack.yaml">
```yaml
components:
  terraform:
    vpc:
      vars:
        # Use the current region for the VPC
        region: !aws.region

      providers:
        aws:
          region: !aws.region
```
</File>

### Resource Naming with Region

<File title="stack.yaml">
```yaml
components:
  terraform:
    s3-bucket:
      vars:
        # Include region in resource names
        bucket_prefix: "myapp-!aws.region"

        tags:
          Region: !aws.region
          Environment: "production"
```
</File>

### Combined with Other AWS Functions

<File title="stack.yaml">
```yaml
components:
  terraform:
    infrastructure:
      vars:
        # All AWS functions share the same cached STS call
        aws_account_id: !aws.account_id
        aws_region: !aws.region
        caller_arn: !aws.caller_identity_arn

        # Construct ARNs dynamically
        resource_prefix: "arn:aws:s3:::myapp-!aws.account_id-!aws.region"
```
</File>

### Cross-Region Configuration

<File title="stack.yaml">
```yaml
components:
  terraform:
    replication-config:
      vars:
        # Use the current region as the source
        source_region: !aws.region

        # Replicate to a different region (hardcoded destination)
        destination_region: "eu-west-1"
```
</File>

## Region Resolution Order

The region is resolved in the following order:

1. **Atmos Auth Context** - If using Atmos authentication with a region specified
2. **AWS_REGION environment variable**
3. **AWS_DEFAULT_REGION environment variable**
4. **Shared config file** (`~/.aws/config`) - The `region` setting for the active profile
5. **Instance metadata** - For EC2 instances or ECS tasks

## Error Handling

If the function fails to determine the AWS region (e.g., no credentials available,
no region configured), Atmos will log an error and exit.

Common error scenarios:
- No AWS credentials configured
- No region specified in credentials, config, or environment
- Network connectivity issues (for STS call)

## Considerations

- **Requires valid AWS credentials** - The function needs credentials to make the STS call
- **Region must be configured** - Either via environment, config file, or Atmos auth
- **Performance** - Results are cached and shared with other AWS identity functions
- **IAM permissions** - Requires `sts:GetCallerIdentity` permission

## Related Functions

- [!aws.account_id](/functions/yaml/aws.account-id) - Get the AWS account ID
- [!aws.caller_identity_arn](/functions/yaml/aws.caller-identity-arn) - Get the full ARN
- [!aws.caller_identity_user_id](/functions/yaml/aws.caller-identity-user-id) - Get the user ID
