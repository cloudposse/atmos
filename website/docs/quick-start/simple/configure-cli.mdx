---
title: Configure Atmos CLI
sidebar_position: 2
sidebar_label: Configure Atmos CLI
---
import EmbedFile from '@site/src/components/EmbedFile';
import KeyPoints from '@site/src/components/KeyPoints';

The `atmos.yaml` configuration file is used to control the behavior of the `atmos` CLI and how Atmos will work with your project. 
Therefore, this file should exist in the project repository, along side your Terraform components and Atmos stacks.

<KeyPoints>
- How to set up base paths for components, stacks, and workflows in `atmos.yaml`.
- How Atmos identifies stack configurations using context variables and naming patterns.
</KeyPoints>

Let's start by configuring `atmos.yaml` to tell Atmos where to find the Terraform components and Atmos stacks (because everything is configurable!)

Below is the minimum recommended configuration for Atmos to work with Terraform and to configure [Atmos components](/core-concepts/components) 
and [Atmos stacks](/core-concepts/stacks). Copy this YAML config below into your `atmos.yaml` file.

<br/>

<EmbedFile filePath="examples/demo-stacks/atmos.yaml" />

__NOTE:__ For the description of all the sections, refer to [CLI Configuration](/cli/configuration).

And here's what all that means...

## Basic Settings

<dl>
  <dt>`stacks.name_pattern`</dt>
  <dd>
    Atmos uses “slugs” to refer to stacks, defined by the name_pattern setting.<br/>
    Instead of relying on file names and locations, which can change, Atmos uses context variables (`namespace`, `tenant`, `environment`, `stage`) 
    to identify the stack. For example, with the command `atmos terraform apply myapp -s dev`, 
    Atmos interprets the slug `dev` using the pattern `{stage}` to locate the correct stack configuration
    in the stacks directory.
  </dd>

  <dt>`logs.level`</dt>
  <dd>
    Set to `Info` to see the most helpful logs. You can also set it to `Trace` to see all the logs, which is helpful for debugging.
  </dd>
  
  <dt>`logs.file`</dt>
  <dd>
    Set to `/dev/stderr` to send all of Atmos output to the standard error stream. This is useful when running Atmos in a CI/CD pipeline.
  </dd>
</dl>

## Path Configuration

Well-known paths are how Atmos knows how to find all your stack configurations, comoponents and workflows.

<dl>
  <dt>`base_path`</dt>
  <dd>The base path for components, stacks, and workflows configurations. We set it to an empty string because we've decided to use the ENV var `ATMOS_BASE_PATH` to point to the absolute path of the root of the repo</dd>

  <dt>`components.terraform.base_path`</dt>
  <dd>The base path to the Terraform components (Terraform root modules). As described in [Configure Repository](/quick-start/advanced/configure-repository), we've decided to put the Terraform components into the `components/terraform` directory, and this setting tells Atmos where to find them. Atmos will join the base path (set in the `ATMOS_BASE_PATH` ENV var) with `components.terraform.base_path` to calculate the final path to the Terraform components</dd>

  <dt>`stacks.base_path`</dt>
  <dd>The base path to the Atmos stacks. As described in [Configure Repository](/quick-start/advanced/configure-repository), we've decided to put the stack configurations into the `stacks` directory, and this setting tells Atmos where to find them. Atmos will join the base path (set in the `ATMOS_BASE_PATH` ENV var) with `stacks.base_path` to calculate the final path to the stacks</dd>

  <dt>`stacks.included_paths`</dt>
  <dd>List of file paths to the top-level stacks in the `stacks` directory to include in search when Atmos searches for the stack where the component is defined when executing `atmos` commands</dd>

  <dt>`stacks.excluded_paths`</dt>
  <dd>List of file paths to the top-level stacks in the `stacks` directory to exclude from search when Atmos searches for the stack where the component is defined when executing `atmos` commands</dd>

  <dt>`workflows.base_path`</dt>
  <dd>The base path to Atmos [Workflows](/core-concepts/workflows) files</dd>
</dl>


<details>
<summary>Advanced Options</summary>
<dl>
  <dt>components.terraform.apply_auto_approve</dt>
  <dd>if set to `true`, Atmos automatically adds the `-auto-approve` option to instruct Terraform to apply the plan without 
  asking for confirmation when executing `terraform apply` command</dd>

  <dt>`components.terraform.deploy_run_init`</dt>
  <dd>if set to `true`, Atmos runs `terraform init` before executing [`atmos terraform deploy`](/cli/commands/terraform/deploy) command</dd>

  <dt>`components.terraform.init_run_reconfigure`</dt>
  <dd>if set to `true`, Atmos automatically adds the `-reconfigure` option to update the backend configuration when executing `terraform init` command</dd>

  <dt>`components.terraform.auto_generate_backend_file`</dt>
  <dd>if set to `true`, Atmos automatically generates the Terraform backend file from the component configuration when executing `terraform plan` and `terraform apply` commands</dd>

  <dt>`commands`</dt>
  <dd>configuration for [Atmos Custom Commands](/core-concepts/custom-commands)</dd>

  <dt>`schemas`</dt>
  <dd>
  [JSON Schema](https://json-schema.org/) and [OPA Policy](https://www.openpolicyagent.org/) configurations for:
  - [Atmos Manifests Validation](/cli/schemas)
  - [Atmos Components Validation](/core-concepts/validate/components)
  </dd>
</dl>

</details>


## Config File Location

While placing `atmos.yaml` at the root of the repository will work for the `atmos` CLI, it will not work
for [Component Remote State](/core-concepts/components/terraform/remote-state) because it uses
the [terraform-provider-utils](https://github.com/cloudposse/terraform-provider-utils) Terraform provider. Terraform executes the provider from the
component's folder (e.g. `components/terraform/vpc`), and we don't want to replicate `atmos.yaml` into every component's folder.

Both the `atmos` CLI and [terraform-provider-utils](https://github.com/cloudposse/terraform-provider-utils) Terraform provider use the same `Go` code,
which try to locate the [CLI config](/cli/configuration) `atmos.yaml` file before parsing and processing [Atmos stacks](/core-concepts/stacks).

This means that `atmos.yaml` file must be at a location in the file system where all processes can find it.

<details>
<summary>How is the `atmos.yaml` file located?</summary>

`atmos.yaml` is loaded from the following locations (from lowest to highest priority):

- System dir (`/usr/local/etc/atmos/atmos.yaml` on Linux, `%LOCALAPPDATA%/atmos/atmos.yaml` on Windows)
- Home dir (`~/.atmos/atmos.yaml`)
- Current directory
- ENV var `ATMOS_CLI_CONFIG_PATH`

:::note

Initial Atmos configuration can be controlled by these ENV vars:

<dl>
  <dt>`ATMOS_CLI_CONFIG_PATH`</dt>
  <dd>Directory that contains the `atmos.yaml` (just the folder without the file name). It's not possible to change the filename at this time.</dd>

  <dt>`ATMOS_BASE_PATH`</dt>
  <dd>Base path to the `components/` and `stacks/` folders.</dd>
</dl>
:::
</details>


## Additional Reading

For the description of all the sections of the `atmos.yaml`, refer to [CLI Configuration](/cli/configuration).
