# yaml-language-server: $schema=https://atmos.tools/schemas/atmos/atmos-manifest/1.0/atmos-manifest.json

vars:
  stage: nonprod

components:
  terraform:
    component-1:
      vars:
        cidr: '{{ atmos.Store "redis" "prod" "vpc" "cidr" }}'
        c_d: '{{ (atmos.Store "redis" .stack "c2" "map").c.d }}'
        c: !template '{{ (atmos.Store "redis" .stack "c2" "map").c | toJSON }}'
        lambda_environment:
          ENGINE_CONFIG_JSON: >
            {
              "vpc_cidr": {{ atmos.Store "redis" "prod" "vpc" "cidr" }},
              "c": {{ (atmos.Store "redis" .stack "c2" "map").c | toJSON }},
              "c_e": {{ (atmos.Store "redis" .stack "c2" "map").c.e }}
            }
