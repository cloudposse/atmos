# Test fixture for combined source provisioner + workdir integration
# Tests JIT vendoring with workdir isolation for terraform, helmfile, and packer
#
# Workflow:
# 1. Source provisioner vendors remote source to components/<type>/<component>/
# 2. When workdir enabled, vendors directly to .workdir/<type>/<stack>-<component>/
# 3. Commands run in the isolated workdir
#
# Manual testing:
#   cd tests/fixtures/scenarios/source-provisioner-workdir
#
#   # Terraform
#   atmos terraform source pull vpc-remote-workdir --stack dev
#   atmos terraform plan vpc-remote-workdir -s dev
#
#   # Helmfile
#   atmos helmfile source pull nginx-workdir --stack dev
#
#   # Packer
#   atmos packer source pull ami-workdir --stack dev

base_path: "./"

components:
  terraform:
    base_path: "components/terraform"
    apply_auto_approve: false
    deploy_run_init: true
    init_run_reconfigure: true
    auto_generate_backend_file: false
  helmfile:
    base_path: "components/helmfile"
  packer:
    base_path: "components/packer"

stacks:
  base_path: "stacks"
  included_paths:
    - "deploy/**/*"
  name_pattern: "{stage}"

logs:
  file: "/dev/stderr"
  level: Info
