# yaml-language-server: $schema=https://atmos.tools/schemas/atmos/atmos-manifest/1.0/atmos-manifest.json

vars:
  stage: nonprod

import:
  - catalog/aws/bastion/defaults
  - catalog/aws/multi-file/defaults

components:
  packer:
    aws/bastion:
      vars:
        # Define the variables specific to the `nonprod` account
        instance_type: "t4g.small"
        volume_size: 8
        assume_role_arn: null
        # assume_role_arn: "arn:aws:iam::NONPROD_ACCOUNT_ID:role/ROLE_NAME"
        ami_tags:
          Stage: nonprod

    # Multi-file component test - uses directory mode (no template specified)
    aws/multi-file:
      vars:
        instance_type: "t3.micro"
        tags:
          Stage: nonprod

    # Abstract component test - cannot be built directly
    aws/bastion-abstract:
      metadata:
        type: abstract
        component: aws/bastion
      vars:
        instance_type: "t4g.small"

    # Locked component test - cannot be modified
    aws/bastion-locked:
      metadata:
        locked: true
        component: aws/bastion
      vars:
        instance_type: "t4g.small"
