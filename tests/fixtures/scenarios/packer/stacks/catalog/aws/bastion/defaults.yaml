# yaml-language-server: $schema=https://atmos.tools/schemas/atmos/atmos-manifest/1.0/atmos-manifest.json

# https://developer.hashicorp.com/packer/integrations/hashicorp/amazon/latest/components/builder/ebs

components:
  packer:
    aws/bastion:
      settings:
        ami:
          source_ami: "ami-0013ceeff668b979b"
          source_ami_name: "al2023-ami-2023.7.20250527.1-kernel-6.12-arm64"
          source_ami_description: "Amazon Linux 2023 AMI 2023.7.20250527.1 arm64 HVM kernel-6.12"
          source_ami_owner_account_id: "137112412989"
      metadata:
        component: aws/bastion
      vars:
        ami_name: "bastion"
        source_ami: "{{ .settings.ami.source_ami }}"
        region: us-east-2
        org_arn: "arn:aws:organizations::123456789012:organization/o-abcde12345"
        kms_key_arn: "arn:aws:kms:us-east-1:111122223333:key/1234abcd-12ab-34cd-56ef-1234567890ab"
        ssh_username: "ec2-user"
        associate_public_ip_address: true
        volume_type: "gp3"
        encrypt_boot: true
        skip_create_ami: true
        manifest_file_name: "manifest.json"
        manifest_strip_path: false
        assume_role_session_name: "atmos-packer"
        assume_role_duration_seconds: 1800
        ami_tags:
          SourceAMI: "{{ .settings.ami.source_ami }}"
          SourceAMIName: "{{ .settings.ami.source_ami_name }}"
          SourceAMIDescription: "{{ .settings.ami.source_ami_description }}"
          SourceAMIOwnerAccountId: "{{ .settings.ami.source_ami_owner_account_id }}"
          ScanStatus: pending
