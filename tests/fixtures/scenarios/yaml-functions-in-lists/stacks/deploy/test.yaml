# Test stack with YAML functions in lists

vars:
  stage: test

components:
  terraform:
    # Components that will provide outputs for testing
    image1-ecr:
      metadata:
        component: mock
      vars:
        repo_name: image1

    image2-ecr:
      metadata:
        component: mock
      vars:
        repo_name: image2

    image3-ecr:
      metadata:
        component: mock
      vars:
        repo_name: image3

    # Component that uses YAML functions in lists (reproducing the reported issue)
    ecr-deployer-role:
      metadata:
        component: mock
      vars:
        # Test case 1: Multiple terraform.output functions in a list
        ecr_repository_arns:
          - !terraform.output image1-ecr test repository_arn
          - !terraform.output image2-ecr test repository_arn
          - !terraform.output image3-ecr test repository_arn

        # Test case 2: Mixed list with functions and static values
        mixed_list:
          - "static-value-1"
          - !terraform.output image1-ecr test repository_arn
          - "static-value-2"
          - !terraform.output image2-ecr test repository_arn

        # Test case 3: List with terraform.state functions
        list_with_functions:
          - !terraform.state image1-ecr test repository_arn
          - !terraform.state image2-ecr test repository_arn
