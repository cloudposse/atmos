# yaml-language-server: $schema=schema.json
# UI output tests for commands that use colored checkmarks and X marks

tests:
  - name: "atmos docs generate readme with UI output"
    enabled: true
    snapshot: true
    description: "Verify docs generate shows checkmark on success"
    workdir: "fixtures/scenarios/docs-generate/terraform/"
    command: "atmos"
    args:
      - "docs"
      - "generate"
      - "readme"
    expect:
      exit_code: 0
      stderr:
        - "✓ Generated docs"
      file_exists:
        - "README.md"

  - name: "atmos validate component success with UI output"
    enabled: true
    snapshot: true
    description: "Verify validate component shows checkmark on success"
    workdir: "fixtures/scenarios/complete"
    command: "atmos"
    args:
      - "validate"
      - "component"
      - "test/test-component-override"
      - "-s"
      - "tenant1-ue2-dev"
    expect:
      exit_code: 0
      stderr:
        - "✓.*validated successfully"

  - name: "atmos validate component failure with UI output"
    enabled: true
    snapshot: true
    description: "Verify validate component shows X mark on failure"
    workdir: "fixtures/scenarios/complete"
    command: "atmos"
    args:
      - "validate"
      - "component"
      - "infra/vpc"
      - "-s"
      - "tenant1-ue2-dev"
    expect:
      exit_code: 1
      stderr:
        - "✗ Component validation failed"

  - name: "atmos validate schema success with UI output"
    enabled: true
    snapshot: true
    description: "Verify validate schema shows checkmark for valid files"
    workdir: "fixtures/scenarios/complete"
    command: "atmos"
    args:
      - "validate"
      - "schema"
      - "-f"
      - "stacks/catalog/terraform/test-component.yaml"
    expect:
      exit_code: 0
      stderr:
        - "✓.*Validated"

  - name: "atmos terraform clean with UI output"
    enabled: true
    snapshot: true
    description: "Verify terraform clean output (checkmark shown when files deleted)"
    workdir: "fixtures/scenarios/complete"
    command: "atmos"
    args:
      - "terraform"
      - "clean"
      - "test/test-component"
      - "-s"
      - "tenant1-ue2-dev"
    expect:
      exit_code: 0
      # Note: terraform clean only shows checkmark if it actually deletes files
      # This test captures baseline output for regression testing

  - name: "atmos version check with UI output"
    enabled: true
    snapshot: true
    description: "Verify version check shows appropriate output"
    workdir: "fixtures/scenarios/complete"
    command: "atmos"
    args:
      - "version"
      - "--check"
    env:
      # Disable version check to avoid network calls in tests
      ATMOS_LOGS_LEVEL: "Info"
    expect:
      exit_code: 0
