tests:
  - name: completion for component should be suggested
    enabled: true
    snapshot: true
    description: "Test tab completions for component"
    workdir: "fixtures/scenarios/completions"
    command: "atmos"
    args:
      - "__completeNoDesc"
      - "terraform"
      - "plan"
      - "\"\""
    expect:
      diff: []
      stdout:
        - "myapp"
      exit_code: 0
  - name: completion for stacks should be suggested
    enabled: true
    snapshot: true
    description: "Test tab completions for stacks"
    workdir: "fixtures/scenarios/completions"
    command: "atmos"
    args:
      - "__completeNoDesc"
      - "terraform"
      - "plan"
      - "myapp"
      - "--stack="
    expect:
      diff: []
      stdout:
        - "dev"
      exit_code: 0
  - name: completion for stacks should be filtered by component
    enabled: true
    snapshot: true
    description: "Test that stack completion is filtered when component is specified"
    workdir: "fixtures/scenarios/completions"
    command: "atmos"
    args:
      - "__completeNoDesc"
      - "terraform"
      - "plan"
      - "vpc"
      - "--stack="
    expect:
      diff: []
      stdout:
        - "dev"
        - "prod"
      exit_code: 0

  # Path-based completion tests
  - name: completion for path should enable directory suggestions
    enabled: true
    snapshot: true
    description: "Test that directory completion is enabled for path input"
    workdir: "fixtures/scenarios/completions"
    command: "atmos"
    env:
      ATMOS_CLI_CONFIG_PATH: "."
    args:
      - "__completeNoDesc"
      - "terraform"
      - "plan"
      - "./"
    expect:
      diff: []
      stdout:
        - ":16"  # ShellCompDirectiveFilterDirs = 16
      exit_code: 0

  - name: completion for current directory path
    enabled: true
    snapshot: true
    description: "Test directory completion for current directory"
    workdir: "fixtures/scenarios/completions"
    command: "atmos"
    env:
      ATMOS_CLI_CONFIG_PATH: "."
    args:
      - "__completeNoDesc"
      - "terraform"
      - "plan"
      - "."
    expect:
      diff: []
      stdout:
        - ":16"  # ShellCompDirectiveFilterDirs = 16
      exit_code: 0
