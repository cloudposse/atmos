# yaml-language-server: $schema=schema.json

tests:
  # Validation Tests
  - name: atmos auth merging
    enabled: true
    snapshot: true
    description: "Test auth merging"
    workdir: "fixtures/scenarios/atmos-auth/"
    command: "atmos"
    args:
      - "describe"
      - "component"
      - "mycomponent"
      - "-s"
      - "component-auth"
      - "--identity"
      - "off"
      - "-q"
      - ".auth"
    expect:
      diff: [ ]
      sanitize:
        # Normalize realm hash which varies by environment (derived from config path)
        "realm: [a-f0-9]+": "realm: <hash>"
      stdout:
        - "provider-oidc:"
        - "kind: github/oidc"
        - "region: us-east-1"
      exit_code: 0
