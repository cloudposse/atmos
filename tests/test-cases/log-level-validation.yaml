tests:
  - name: "Invalid Log Level in Config File"
    enabled: true
    snapshot: true
    description: "Test validation of invalid log level in atmos.yaml config file"
    workdir: "fixtures/scenarios/invalid-log-level"
    command: "atmos"
    args:
      - terraform
      - plan
      - test
      - -s
      - test
    expect:
      diff: []
      exit_code: 1
      stderr:
        - "Error: Invalid log level 'XTrace'\\. Valid options are: \\[Trace, Debug, Info, Warning, Off\\]\n"

  - name: "Invalid Log Level in Environment Variable"
    enabled: true
    snapshot: true
    description: "Test validation of invalid log level in ATMOS_LOGS_LEVEL env var"
    workdir: "../"
    command: "atmos"
    args:
      - terraform
      - plan
      - test
      - -s
      - test
    env:
      ATMOS_LOGS_LEVEL: XTrace
    expect:
      diff: []
      exit_code: 1
      stderr:
        - "Error: Invalid log level 'XTrace' set in the ATMOS_LOGS_LEVEL environment variable\\. Valid options are: \\[Trace, Debug, Info, Warning, Off\\]\n"

  - name: "Valid Log Level in Config File"
    enabled: true
    snapshot: true
    description: "Test validation of valid log level in atmos.yaml config file"
    workdir: "fixtures/scenarios/valid-log-level"
    command: "atmos"
    args:
      - version
    expect:
      diff:
        - '游놓 Atmos (\d+\.\d+\.\d+|test) on [a-z]+/[a-z0-9]+'
      stdout:
        - '^\n游놓 Atmos (\d+\.\d+\.\d+|test) on [a-z]+/[a-z0-9_]+\n\n$'
      stderr:
        - "^$"
      exit_code: 0

  - name: "Valid Log Level in Environment Variable"
    enabled: true
    snapshot: true
    description: "Test validation of valid log level in ATMOS_LOGS_LEVEL env var"
    workdir: "../"
    command: "atmos"
    args:
      - version
    env:
      ATMOS_LOGS_LEVEL: Debug
    expect:
      diff:
        - '游놓 Atmos (\d+\.\d+\.\d+|test) on [a-z]+/[a-z0-9]+'
      stdout:
        - '^\n游놓 Atmos (\d+\.\d+\.\d+|test) on [a-z]+/[a-z0-9_]+\n\n'
      stderr:
        - "^$"
      exit_code: 0

  - name: "Valid Log Level in Command Line Flag"
    enabled: true
    snapshot: true
    description: "Test validation of valid log level in --logs-level flag"
    workdir: "../"
    command: "atmos"
    args:
      - --logs-level
      - Info
      - version
    expect:
      diff:
        - '游놓 Atmos (\d+\.\d+\.\d+|test) on [a-z]+/[a-z0-9]+'
      stdout:
        - '^\n游놓 Atmos (\d+\.\d+\.\d+|test) on [a-z]+/[a-z0-9_]+\n\n$'
      stderr:
        - "^$"
      exit_code: 0

  - name: "Invalid Log Level in Command Line Flag"
    enabled: true
    description: "Test validation of invalid log level in --logs-level flag"
    workdir: "../"
    command: "atmos"
    args:
      - --logs-level
      - XTrace
      - version
    expect:
      exit_code: 1
      stderr:
        - "Error: Invalid log level 'XTrace' specified with the --logs-level flag\\. Valid options are: \\[Trace, Debug, Info, Warning, Off\\]\\n"
