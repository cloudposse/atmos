# Toolchain Integration Demo Workflows
#
# These workflows demonstrate how tools from .tool-versions are automatically
# available in workflow steps without explicit dependencies declaration.

name: Toolchain Demo
description: Workflows demonstrating automatic toolchain integration

workflows:
  # Show which binaries are being used
  which-tools:
    description: Show paths to toolchain-managed binaries
    steps:
      - name: which-jq
        command: which jq
        type: shell
      - name: which-yq
        command: which yq
        type: shell

  # Show tool versions
  tool-versions:
    description: Show versions of toolchain-managed tools
    steps:
      - name: jq-version
        command: jq --version
        type: shell
      - name: yq-version
        command: yq --version
        type: shell

  # Demonstrate jq processing
  jq-demo:
    description: Demonstrate jq processing JSON data
    steps:
      - name: parse-json
        command: echo '{"tool":"atmos","feature":"toolchain"}' | jq -r '.tool'
        type: shell

  # Demonstrate yq processing
  yq-demo:
    description: Demonstrate yq processing YAML data
    steps:
      - name: parse-yaml
        command: "echo 'tool: atmos' | yq -r '.tool'"
        type: shell

  # Combined demo showing full toolchain integration
  full-demo:
    description: Complete toolchain integration demonstration
    steps:
      - name: intro
        command: echo "=== Toolchain Integration Demo ==="
        type: shell
      - name: show-jq-path
        command: "echo 'jq path:' && which jq"
        type: shell
      - name: show-yq-path
        command: "echo 'yq path:' && which yq"
        type: shell
      - name: jq-version
        command: "echo 'jq version:' && jq --version"
        type: shell
      - name: yq-version
        command: "echo 'yq version:' && yq --version"
        type: shell
      - name: jq-demo
        command: "echo 'jq demo:' && echo '{\"status\":\"success\"}' | jq -r '.status'"
        type: shell
      - name: yq-demo
        command: "echo 'yq demo:' && echo 'status: success' | yq -r '.status'"
        type: shell

  # Example with explicit dependencies (overrides .tool-versions)
  with-dependencies:
    description: Workflow with explicit tool dependencies
    dependencies:
      tools:
        jq: "1.7.1"
        yq: "4.45.1"
    steps:
      - name: show-versions
        command: "echo 'jq:' && jq --version && echo 'yq:' && yq --version"
        type: shell
