# Lychee link checker configuration
# https://github.com/lycheeverse/lychee
#
# Run locally: make link-check
# Or directly: lychee --config lychee.toml '**/*.md'

# Log level: "error", "warn", "info", "debug", "trace"
verbose = "info"

# Don't show progress bar (cleaner CI output)
no_progress = true

# Timeout for each request (seconds)
timeout = 60

# Retry failed requests
max_retries = 3

# Accept these HTTP status codes as valid
accept = ["200", "204", "301", "302", "403", "429"]

# Paths to exclude from checking (input files to scan)
exclude_path = [
  "website",
  "node_modules",
  ".git",
  ".conductor",
]

# URL patterns to exclude (regex)
exclude = [
  "localhost",
  "127\\.0\\.0\\.1",
  "example\\.com",
  "cpco\\.io",
  "cloudposse\\.com.*utm_",
  # Private GitHub org (not accessible to CI)
  "github\\.com/cloudposse-corp",
  "slack\\.cloudposse\\.com",
  "wttr\\.in",
  # GNU.org (rate limits and connection resets)
  "gnu\\.org",
  # Linux Foundation specs (slow response times)
  "refspecs\\.linuxfoundation\\.org",
  # Kubernetes.io (rate limits and connection resets in CI)
  "kubernetes\\.io",
  # Cloudinary image resizing proxy
  "img\\.cloudposse\\.com",
  # atmos.tools URLs (can't verify website links locally)
  "atmos\\.tools",
  # Root-relative paths converted to file:// URLs (atmos.tools website paths)
  "file://.*/cli/",
  # Files that don't exist yet (planned documentation)
  "website/docs/cli/errors\\.mdx",
  "website/docs/cli/configuration/mask\\.mdx",
  # Documentation template placeholder (intentional)
  "github\\.com/cloudposse/atmos/issues/XXXX",
  # GitHub redirects (expected behavior)
  "github\\.com/cloudposse/atmos/releases/latest",
  "github\\.com/codespaces",
  # Raw file URLs redirect through GitHub's CDN (by design)
  "\\?raw=true",
  # shields.io redirects /github/release/ to /github/v/release/ internally (both work)
  "img\\.shields\\.io/github/release/",
  # Atmos Pro redirects to sign-in page for unauthenticated users
  "atmos-pro\\.com",
  # LF AI Foundation blog links (may change or be unavailable)
  "lfaidata\\.foundation",
  # Test data placeholder URLs (intentional)
  "github\\.com/test/",
  # Planned documentation paths (not yet published)
  "file://.*/ai/skills",
  "file://.*/ai/skill-marketplace",
]
